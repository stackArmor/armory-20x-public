import{a as O,R as P,p as e,v as ue,A as ge,q as xe}from"./chunk-C37GKA54-CG9TNitP.js";import{S as Y,u as pe,A as fe,H as je}from"./HelpIcon-C1bK2S4u.js";import{aj as ye,ak as be,l as ee,m as se,u as ve,al as we,B as S,am as Se,j as Ie,x as Ce,y as ze,q as ke,an as $e,ao as Re,F as Le,H as te,J as w,T as p,U as ce,S as z,Y as Ae,N as H,Z as _,ap as Me,L as de,R as K,O as Te,P as Pe,$ as J,a0 as Ee,V as B,Q as De,W as ie}from"./dashboardStore-j1afM62Q.js";import{C as L,S as Ne}from"./Select-CheMonxa.js";import{T as Z,S as Q}from"./IconHelp-BOZOBTM8.js";import{C as F,A as ae}from"./Code-CWuSGdGG.js";import{I as Be,D as Ue}from"./DataTable-CPOdM8-C.js";import{P as _e,d as Fe,I as We,a as qe}from"./proxy-D9byw6Yg.js";import{a as Ke}from"./index-bL05S6fw.js";import{T as Oe,I as He}from"./IconSearch-DEKIV24a.js";import"./Table-CI8EG-wr.js";function Ve(t){if(!t||typeof t=="string")return 0;const o=t/36;return Math.round((4+15*o**.25+o/5)*10)}function X(t){return t!=null&&t.current?t.current.scrollHeight:"auto"}const U=typeof window<"u"&&window.requestAnimationFrame,oe=0,Ge=t=>({height:0,overflow:"hidden",...t?{}:{display:"none"}});function Je({transitionDuration:t,transitionTimingFunction:o="ease",onTransitionEnd:r=()=>{},opened:i,keepMounted:c=!1}){const l=O.useRef(null),x=Ge(c),[h,I]=O.useState(i?{}:x),C=n=>{Ke.flushSync(()=>I(n))},m=n=>{C(y=>({...y,...n}))};function f(n){const y=t||Ve(n);return{transition:`height ${y}ms ${o}, opacity ${y}ms ${o}`}}ye(()=>{typeof U=="function"&&U(i?()=>{m({willChange:"height",display:"block",overflow:"hidden"}),U(()=>{const n=X(l);m({...f(n),height:n})})}:()=>{const n=X(l);m({...f(n),willChange:"height",height:n}),U(()=>m({height:oe,overflow:"hidden"}))})},[i]);const j=n=>{if(!(n.target!==l.current||n.propertyName!=="height"))if(i){const y=X(l);y===h.height?C({}):m({height:y}),r()}else h.height===oe&&(C(x),r())};function v({style:n={},refKey:y="ref",...g}={}){const M=g[y],k={"aria-hidden":!i,...g,[y]:be(l,M),onTransitionEnd:j,style:{boxSizing:"border-box",...n,...h}};return P.version.startsWith("18")?i||(k.inert=""):k.inert=!i,k}return v}const Qe={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},me=ee((t,o)=>{const{children:r,in:i,transitionDuration:c,transitionTimingFunction:l,style:x,onTransitionEnd:h,animateOpacity:I,keepMounted:C,...m}=se("Collapse",Qe,t),f=ve(),j=we(),n=(f.respectReducedMotion?j:!1)?0:c,y=Je({opened:i,transitionDuration:n,transitionTimingFunction:l,onTransitionEnd:h,keepMounted:C});return n===0?i?e.jsx(S,{...m,children:r}):null:e.jsx(S,{...y({style:{opacity:i||!I?1:0,transition:I?`opacity ${n}ms ${l}`:"none",...Se(x,f)},ref:o,...m}),children:r})});me.displayName="@mantine/core/Collapse";const[Xe,Ye]=Ie("List component was not found in tree");var re={root:"m_abbac491",item:"m_abb6bec2",itemWrapper:"m_75cd9f71",itemIcon:"m_60f83e5b"};const ne=ee((t,o)=>{const r=se("ListItem",null,t),{classNames:i,className:c,style:l,styles:x,vars:h,icon:I,children:C,mod:m,...f}=r,j=Ye(),v=I||j.icon,n={classNames:i,styles:x};return e.jsx(S,{...j.getStyles("item",{...n,className:c,style:l}),component:"li",mod:[{"with-icon":!!v,centered:j.center},m],ref:o,...f,children:e.jsxs("div",{...j.getStyles("itemWrapper",n),children:[v&&e.jsx("span",{...j.getStyles("itemIcon",n),children:v}),e.jsx("span",{...j.getStyles("itemLabel",n),children:C})]})})});ne.classes=re;ne.displayName="@mantine/core/ListItem";const Ze={type:"unordered"},es=ze((t,{size:o,spacing:r})=>({root:{"--list-fz":Re(o),"--list-lh":$e(o),"--list-spacing":ke(r)}})),D=ee((t,o)=>{const r=se("List",Ze,t),{classNames:i,className:c,style:l,styles:x,unstyled:h,vars:I,children:C,type:m,withPadding:f,icon:j,spacing:v,center:n,listStyleType:y,mod:g,attributes:M,...k}=r,T=Ce({name:"List",classes:re,props:r,className:c,style:l,classNames:i,styles:x,unstyled:h,attributes:M,vars:I,varsResolver:es});return e.jsx(Xe,{value:{center:n,icon:j,getStyles:T},children:e.jsx(S,{...T("root",{style:{listStyleType:y}}),component:m==="unordered"?"ul":"ol",mod:[{"with-padding":f},g],ref:o,...k,children:C})})});D.classes=re;D.displayName="@mantine/core/List";D.Item=ne;/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],le=Le("outline","external-link","ExternalLink",ss);function W({label:t,icon:o,color:r="gray",size:i="md",variant:c="soft",count:l,active:x=!1,onClick:h,style:I,className:C}){const{colorScheme:m}=te(),f=i==="sm"?22:28,j=i==="sm"?8:10,v=i==="sm"?6:8,n=P.useMemo(()=>c==="ghost"?{bg:"transparent",border:"transparent",text:`var(--mantine-color-${r}-7)`,hoverBg:m==="dark"?`var(--mantine-color-${r}-9)`:`var(--mantine-color-${r}-0)`}:c==="outline"?{bg:"transparent",border:m==="dark"?`var(--mantine-color-${r}-7)`:`var(--mantine-color-${r}-4)`,text:m==="dark"?`var(--mantine-color-${r}-2)`:`var(--mantine-color-${r}-7)`,hoverBg:m==="dark"?`var(--mantine-color-${r}-9)`:`var(--mantine-color-${r}-0)`}:{bg:m==="dark"?`var(--mantine-color-${r}-9)`:`var(--mantine-color-${r}-0)`,border:m==="dark"?`var(--mantine-color-${r}-7)`:`var(--mantine-color-${r}-3)`,text:m==="dark"?`var(--mantine-color-${r}-2)`:`var(--mantine-color-${r}-7)`,hoverBg:m==="dark"?`var(--mantine-color-${r}-8)`:`var(--mantine-color-${r}-1)`},[r,c,m]),y=e.jsxs(w,{gap:v,align:"center",style:{height:f,paddingInline:j,borderRadius:9999,border:`1px solid ${n.border}`,backgroundColor:n.bg,color:n.text,transition:"background-color 150ms ease, border-color 150ms ease, transform 150ms ease",boxShadow:x?"inset 0 0 0 1px var(--mantine-color-primary-6)":void 0,...I},className:C,children:[o,typeof t=="string"?e.jsx(p,{size:i==="sm"?"xs":"sm",style:{color:"inherit",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},maw:typeof maxLabelWidth<"u"?maxLabelWidth:void 0,children:t}):t,typeof l=="number"&&e.jsx(S,{style:{marginLeft:2,minWidth:i==="sm"?16:18,height:i==="sm"?16:18,borderRadius:9999,display:"inline-flex",alignItems:"center",justifyContent:"center",backgroundColor:`var(--mantine-color-${r}-6)`,color:"var(--mantine-color-white)",fontSize:i==="sm"?10:11,paddingInline:6},children:l})]});return h?e.jsx(ce,{onClick:h,style:{borderRadius:9999},children:y}):e.jsx(S,{children:y})}function ts({items:t,onSelect:o,title:r="Top KSI families"}){const{colorScheme:i}=te();if(!t||t.length===0)return null;const c=Math.max(...t.map(l=>l.count));return e.jsxs(z,{gap:"xs",children:[e.jsxs(p,{size:"xs",c:"dimmed",children:[r,":"]}),e.jsx(Y,{cols:{base:1,sm:2},spacing:"xs",children:t.map(l=>{const x=c>0?Math.max(6,Math.round(l.count/c*100)):0,h=e.jsxs(z,{gap:6,children:[e.jsxs(w,{gap:6,justify:"space-between",wrap:"nowrap",children:[e.jsx(p,{size:"sm",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:l.label}),e.jsx(F,{style:{fontSize:"var(--mantine-font-size-xs)"},children:l.count})]}),e.jsx(_e,{value:x,size:"xs",radius:"xl",styles:{root:{background:i==="dark"?"var(--mantine-color-dark-6)":"var(--mantine-color-gray-1)"}}})]});return o?e.jsx(ce,{onClick:()=>o==null?void 0:o(l.id),style:{width:"100%",borderRadius:10,border:`1px solid ${i==="dark"?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-3)"}`,padding:10,transition:"background-color 120ms ease, transform 120ms ease, border-color 120ms ease"},children:h},l.id):e.jsx(S,{style:{width:"100%",borderRadius:10,border:`1px solid ${i==="dark"?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-3)"}`,padding:10},children:h},l.id)})})]})}function rs(t,o,r){if(!t.results||t.results.length===0)return null;const i=t.results.filter(x=>x.status==="alarm"),c=t.results.filter(x=>x.status==="error"),l=i.length+c.length;return l===0?null:{id:t.control_id||`control-${Math.random().toString(36).substr(2,9)}`,title:t.title||"Unnamed Control",controlId:t.control_id||"",category:o,categoryId:r,alarmResults:i,errorResults:c,totalIssues:l}}function he(t,o,r,i){const c=[];if(t.controls)for(const l of t.controls){const x=rs(l,i??t.title,r??t.group_id);if(x&&(c.push(x),o&&c.length>=o))break}if(t.groups&&(!o||c.length<o))for(const l of t.groups){const x=he(l,o?o-c.length:void 0,r??t.group_id,i??t.title);if(c.push(...x),o&&c.length>=o)break}return c}function ns(t,o=20){const r=[];for(const i of t){const c=he(i,o-r.length,i.group_id,i.title);if(r.push(...c),r.length>=o)break}return r.sort((i,c)=>i.errorResults.length>0&&c.errorResults.length===0?-1:c.errorResults.length>0&&i.errorResults.length===0?1:c.totalIssues-i.totalIssues).slice(0,o)}function is({id:t,title:o,controlId:r,category:i,alarmResults:c=[],errorResults:l=[],timestamp:x,onDismiss:h,onAction:I,isDismissible:C=!0,density:m="comfortable"}){const[f,j]=O.useState(!1),[v,n]=O.useState(!1);te();const y=m==="compact"?"sm":"md",g=u=>{const A=u.reduce((b,$)=>{const R=$.reason||"Unknown issue";return b[R]||(b[R]={reason:R,status:$.status,resources:[]}),$.resource&&b[R].resources.push({resource:$.resource,dimensions:$.dimensions}),b},{});return Object.values(A)},M=g(c),k=g(l),T=c.length+l.length,q=c.length>0,N=l.length>0,E={error:{color:"grape",icon:_,bgColor:"grape.0",borderColor:"grape.3",pulse:!0},alarm:{color:"red",icon:H,bgColor:"red.0",borderColor:"red.3",pulse:!0},info:{color:"blue",icon:Ae,bgColor:"blue.0",borderColor:"blue.3",pulse:!1}}[N?"error":q?"alarm":"info"],s=E.icon,d=()=>{n(!0),setTimeout(()=>{h==null||h(t)},300)},a=u=>{if(u.includes("gitlab")){const A=u.split("/");return A[A.length-1]||u}return u};return T===0||v?null:e.jsxs(L,{shadow:"sm",padding:y,radius:"md",withBorder:!0,className:"relative overflow-hidden",style:{borderLeft:`3px solid var(--mantine-color-${E.color}-6)`},children:[e.jsxs(w,{justify:"space-between",mb:"xs",align:"flex-start",children:[e.jsxs(w,{gap:"sm",align:"flex-start",style:{flex:1},children:[e.jsx(Z,{color:E.color,variant:"light",size:"md",radius:"md",children:e.jsx(s,{size:18})}),e.jsxs(S,{style:{flex:1},children:[e.jsxs(w,{gap:"xs",wrap:"nowrap",children:[e.jsx(p,{size:"sm",fw:600,style:{flex:1},children:o}),N&&e.jsx(W,{label:`${l.length} errors`,color:"grape",size:"sm"}),q&&e.jsx(W,{label:`${c.length} alarms`,color:"red",size:"sm"}),i&&e.jsx(W,{label:i,color:"gray",size:"sm",variant:"outline",maxLabelWidth:240})]}),e.jsxs(w,{gap:"xs",mt:2,children:[r&&e.jsx(F,{c:"dimmed",style:{fontSize:"var(--mantine-font-size-xs)"},children:r}),x&&e.jsx(p,{size:"xs",c:"dimmed",children:x})]})]})]}),C&&e.jsx(Me,{size:"sm",onClick:d,"aria-label":"Dismiss alert"})]}),e.jsx(S,{onClick:()=>j(!f),style:{cursor:"pointer"},mb:"sm",children:e.jsxs(w,{justify:"space-between",align:"center",children:[e.jsx(p,{size:"sm",c:"dimmed",fw:500,children:f?"Hide details":`Show details (${T})`}),f?e.jsx(Be,{size:16,color:"var(--mantine-color-dimmed)"}):e.jsx(Fe,{size:16,color:"var(--mantine-color-dimmed)"})]})}),e.jsx(me,{in:f,children:e.jsxs(z,{gap:m==="compact"?"sm":"md",children:[k.length>0&&e.jsxs(S,{children:[e.jsxs(w,{gap:"xs",mb:"xs",children:[e.jsx(_,{size:16,color:"var(--mantine-color-grape-6)"}),e.jsxs(p,{size:"sm",fw:600,c:"grape",children:["Errors (",l.length,")"]})]}),e.jsx(z,{gap:m==="compact"?"xs":"sm",children:k.map((u,A)=>e.jsxs(L,{padding:m==="compact"?"xs":"sm",withBorder:!0,children:[e.jsx(p,{size:"sm",mb:"xs",children:u.reason}),u.resources.length>0&&e.jsxs(S,{children:[e.jsxs(p,{size:"xs",c:"dimmed",mb:4,children:["Affected resources (",u.resources.length,"):"]}),e.jsx(D,{spacing:"xs",size:"sm",children:u.resources.map((b,$)=>e.jsxs(D.Item,{children:[b.resource.startsWith("http")?e.jsxs(ae,{href:b.resource,target:"_blank",size:"sm",style:{display:"flex",alignItems:"center",gap:4},children:[a(b.resource),e.jsx(le,{size:12})]}):e.jsx(F,{style:{fontSize:"var(--mantine-font-size-sm)"},children:b.resource}),b.dimensions&&b.dimensions.length>0&&e.jsx(p,{size:"xs",c:"dimmed",mt:2,children:b.dimensions.map(R=>`${R.key}: ${R.value}`).join(", ")})]},$))})]})]},A))})]}),M.length>0&&e.jsxs(S,{children:[k.length>0&&e.jsx(de,{}),e.jsxs(w,{gap:"xs",mb:"xs",children:[e.jsx(H,{size:16,color:"var(--mantine-color-red-6)"}),e.jsxs(p,{size:"sm",fw:600,c:"red",children:["Alarms (",c.length,")"]})]}),e.jsx(z,{gap:m==="compact"?"xs":"sm",children:M.map((u,A)=>e.jsxs(L,{padding:m==="compact"?"xs":"sm",withBorder:!0,children:[e.jsx(p,{size:"sm",mb:"xs",children:u.reason}),u.resources.length>0&&e.jsxs(S,{children:[e.jsxs(p,{size:"xs",c:"dimmed",mb:4,children:["Affected resources (",u.resources.length,"):"]}),e.jsx(D,{spacing:"xs",size:"sm",children:u.resources.map((b,$)=>e.jsxs(D.Item,{children:[b.resource.startsWith("http")?e.jsxs(ae,{href:b.resource,target:"_blank",size:"sm",style:{display:"flex",alignItems:"center",gap:4},children:[a(b.resource),e.jsx(le,{size:12})]}):e.jsx(F,{style:{fontSize:"var(--mantine-font-size-sm)"},children:b.resource}),b.dimensions&&b.dimensions.length>0&&e.jsx(p,{size:"xs",c:"dimmed",mt:2,children:b.dimensions.map(R=>`${R.key}: ${R.value}`).join(", ")})]},$))})]})]},A))})]})]})}),I&&e.jsx(K,{variant:"light",color:E.color,size:m==="compact"?"xs":"sm",mt:m==="compact"?"xs":"sm",rightSection:e.jsx(We,{size:14}),onClick:I,children:"View Control Details"})]})}const as=Te()(Pe(t=>({dismissedIds:[],dismiss:o=>t(r=>({dismissedIds:r.dismissedIds.includes(o)?r.dismissedIds:[o,...r.dismissedIds].slice(0,500)})),restore:o=>t(r=>({dismissedIds:r.dismissedIds.filter(i=>i!==o)})),clearAll:()=>t({dismissedIds:[]})}),{name:"alerts-storage",partialize:t=>({dismissedIds:t.dismissedIds})})),js=()=>[{title:"Alerts Center"},{name:"description",content:"Centralized view of KSI alarms and errors across all KSI families"}],ys=ue(function(){const{ksiCategories:o,loading:r,error:i}=pe(),[c,l]=ge(),x=xe(),{dismissedIds:h,dismiss:I,restore:C,clearAll:m}=as(),f=c.get("severity")??"all",j=c.get("category")??"all",v=c.get("q")??"",n=c.get("show")??"active",y=c.get("view")??"list",g=P.useMemo(()=>ns(o,500).filter(a=>{const u=f==="all"||f==="alarm"&&a.alarmResults.length>0||f==="error"&&a.errorResults.length>0,A=j==="all"||a.categoryId===j,b=v?(a.title||"").toLowerCase().includes(v.toLowerCase())||(a.category||"").toLowerCase().includes(v.toLowerCase()):!0,$=h.includes(a.id);return u&&A&&b&&(n==="all"?!0:n==="dismissed"?$:!$)}),[o,f,j,v,n,h]),M=P.useMemo(()=>{const s=o.map(d=>({value:d.group_id,label:d.title}));return[{value:"all",label:"All KSI families"},...s]},[o]),k=g.reduce((s,d)=>s+d.errorResults.length,0),T=g.reduce((s,d)=>s+d.alarmResults.length,0),q=new Set(g.map(s=>s.categoryId)).size,N=P.useMemo(()=>{const s=new Map;for(const d of g){if(!d.categoryId)continue;const a=d.categoryId,u=s.get(a)??{id:a,title:d.category??a,count:0};u.count+=d.totalIssues,s.set(a,u)}return Array.from(s.values()).sort((d,a)=>a.count-d.count).slice(0,5)},[g]),V=P.useMemo(()=>n==="dismissed"&&h.length===0?"No alerts to restore. You have not dismissed any alerts.":n==="active"&&g.length===0?v||j!=="all"||f!=="all"?"No alerts match the selected filters.":"No alerts to dismiss. All alerts have been processed.":n==="all"&&g.length===0&&h.length===0?"No alerts to manage. All alerts have been processed.":g.length===0?"No alerts match the selected filters.":"",[n,h.length,g,v,j,f]),G=P.useMemo(()=>n==="dismissed"?0:n==="all"?g.filter(s=>!h.includes(s.id)).length:g.length,[n,g,h]),E=P.useMemo(()=>n==="active"?0:h.length,[n,h.length]);return r?e.jsx(J,{size:"lg",py:"xl",children:e.jsxs(w,{justify:"center",mt:"xl",children:[e.jsx(Ee,{}),e.jsx(p,{children:"Loading alerts…"})]})}):i?e.jsx(J,{size:"lg",py:"xl",children:e.jsx(fe,{color:"red",title:"Failed to load data",variant:"light",children:i})}):e.jsx(J,{size:"xl",py:"lg",children:e.jsxs(z,{gap:"lg",children:[e.jsx(L,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(z,{gap:"sm",children:[e.jsxs(w,{justify:"space-between",align:"center",children:[e.jsxs("div",{children:[e.jsxs(w,{gap:"xs",align:"center",children:[e.jsx(B,{order:2,children:"Alerts Center"}),e.jsx(je,{tooltip:"This page lists alerts that have detailed result rows. Execution errors that appear in dashboard summaries but do not include per-result details are not shown here. That is why the dashboard 'Errors' total can be higher than the count here.",position:"bottom-start"})]}),e.jsx(w,{gap:6,align:"center",children:e.jsx(p,{c:"dimmed",children:"Focused hub for alarms and errors across all KSI families"})})]}),e.jsxs(w,{gap:"xs",children:[e.jsx(W,{label:`${k} errors`,color:"grape",size:"md",icon:e.jsx(_,{size:14})}),e.jsx(W,{label:`${T} alarms`,color:"red",size:"md",icon:e.jsx(H,{size:14})})]})]}),e.jsxs(Y,{cols:{base:2,sm:4},spacing:"sm",children:[e.jsx(L,{withBorder:!0,padding:"sm",radius:"md",children:e.jsxs(z,{gap:2,align:"flex-start",children:[e.jsx(p,{size:"xs",c:"dimmed",children:"Errors"}),e.jsxs(w,{gap:6,children:[e.jsx(Z,{color:"grape",variant:"light",size:"sm",children:e.jsx(_,{size:14})}),e.jsx(B,{order:4,children:k})]})]})}),e.jsx(L,{withBorder:!0,padding:"sm",radius:"md",children:e.jsxs(z,{gap:2,align:"flex-start",children:[e.jsx(p,{size:"xs",c:"dimmed",children:"Alarms"}),e.jsxs(w,{gap:6,children:[e.jsx(Z,{color:"red",variant:"light",size:"sm",children:e.jsx(H,{size:14})}),e.jsx(B,{order:4,children:T})]})]})}),e.jsx(L,{withBorder:!0,padding:"sm",radius:"md",children:e.jsxs(z,{gap:2,align:"flex-start",children:[e.jsx(p,{size:"xs",c:"dimmed",children:"Affected KSI families"}),e.jsx(B,{order:4,children:q})]})}),e.jsx(L,{withBorder:!0,padding:"sm",radius:"md",children:e.jsxs(z,{gap:2,align:"flex-start",children:[e.jsx(p,{size:"xs",c:"dimmed",children:"Visible alerts"}),e.jsx(B,{order:4,children:g.length})]})})]})]})}),e.jsxs(L,{withBorder:!0,padding:"md",radius:"md",children:[e.jsxs(z,{gap:"sm",children:[e.jsxs(w,{justify:"space-between",align:"flex-end",wrap:"wrap",children:[e.jsx(Oe,{label:"Search",placeholder:"Search title or KSI family…",leftSection:e.jsx(He,{size:14}),value:v,onChange:s=>l(d=>{const a=new URLSearchParams(d),u=s.currentTarget.value;return u?a.set("q",u):a.delete("q"),a}),onKeyDown:s=>{s.key==="Escape"&&l(d=>{const a=new URLSearchParams(d);return a.delete("q"),a})},rightSection:v?e.jsx(De,{size:"sm",variant:"subtle",onClick:()=>l(s=>{const d=new URLSearchParams(s);return d.delete("q"),d}),children:e.jsx(_,{size:14})}):void 0,style:{flex:1,minWidth:260,maxWidth:520}}),e.jsxs(w,{gap:"xs",children:[e.jsx(K,{variant:"light",leftSection:e.jsx(qe,{size:16}),onClick:()=>{const s=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),d=URL.createObjectURL(s),a=document.createElement("a");a.href=d,a.download="alerts-export.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(d)},children:"Export"}),n!=="dismissed"&&e.jsx(ie,{label:"No alerts to dismiss",disabled:G>0,children:e.jsx(K,{variant:"subtle",disabled:G===0,onClick:()=>{const s=n==="all"?g.filter(u=>!h.includes(u.id)):g,d=s.length;d<=0||!window.confirm(`Dismiss ${d} visible alert${d===1?"":"s"}?`)||s.forEach(u=>I(u.id))},children:"Dismiss All"})}),n!=="active"&&e.jsx(ie,{label:"No alerts to restore",disabled:E>0,children:e.jsx(K,{variant:"subtle",disabled:E===0,onClick:()=>{const s=h.length;s<=0||!window.confirm(`Restore all dismissed alerts (${s})?`)||m()},children:"Restore All"})})]})]}),e.jsxs(Y,{cols:{base:1,sm:2,md:3,lg:5},spacing:"sm",children:[e.jsxs(S,{children:[e.jsx(p,{size:"xs",c:"dimmed",mb:4,children:"Severity"}),e.jsx(Q,{value:f,onChange:s=>l(d=>{const a=new URLSearchParams(d);return s?a.set("severity",s):a.delete("severity"),a}),data:[{label:"All",value:"all"},{label:"Errors",value:"error"},{label:"Alarms",value:"alarm"}]})]}),e.jsxs(S,{children:[e.jsx(p,{size:"xs",c:"dimmed",mb:4,children:"KSI Family"}),e.jsx(Ne,{value:j,onChange:s=>l(d=>{const a=new URLSearchParams(d);return s?a.set("category",s):a.delete("category"),a}),data:M,w:"100%"})]}),e.jsxs(S,{children:[e.jsx(p,{size:"xs",c:"dimmed",mb:4,children:"Show"}),e.jsx(Q,{value:n,onChange:s=>l(d=>{const a=new URLSearchParams(d);return s?a.set("show",s):a.delete("show"),a}),data:[{label:"Active",value:"active"},{label:"Dismissed",value:"dismissed"},{label:"All",value:"all"}]})]}),e.jsxs(S,{children:[e.jsx(p,{size:"xs",c:"dimmed",mb:4,children:"View"}),e.jsx(Q,{value:y,onChange:s=>l(d=>{const a=new URLSearchParams(d);return s?a.set("view",s):a.delete("view"),a}),data:[{label:"List",value:"list"},{label:"Table",value:"table"}]})]})]})]}),N.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(de,{my:"sm"}),e.jsx(w,{gap:"xs",wrap:"wrap",children:e.jsx(ts,{items:N.map(s=>({id:s.id,label:s.title,count:s.count})),onSelect:s=>l(d=>{const a=new URLSearchParams(d);return a.set("category",s),a})})})]})]}),y==="table"?e.jsx(L,{withBorder:!0,padding:"md",radius:"md",children:e.jsx(Ue,{data:g.map(s=>({title:s.title,category:s.category,controlId:s.controlId,errors:s.errorResults.length,alarms:s.alarmResults.length,total:s.totalIssues})),columns:[{key:"title",label:"Title",sortable:!0,width:"40%"},{key:"category",label:"KSI Family",sortable:!0,width:"25%"},{key:"controlId",label:"Control ID",sortable:!0,width:"15%",render:s=>e.jsx(F,{style:{fontSize:"var(--mantine-font-size-sm)"},children:s})},{key:"errors",label:"Errors",sortable:!0,width:90},{key:"alarms",label:"Alarms",sortable:!0,width:90},{key:"total",label:"Total",sortable:!0,width:90}],pagination:!0,pageSize:10,emptyText:V||"No alerts match the selected filters"})}):e.jsxs(z,{gap:"md",children:[g.length===0&&e.jsx(L,{withBorder:!0,padding:"md",radius:"md",children:e.jsx(p,{c:"dimmed",ta:"center",children:V||"No alerts match the selected filters."})}),g.map(s=>e.jsx(is,{id:s.id,title:s.title,controlId:s.controlId,category:s.category,alarmResults:s.alarmResults,errorResults:s.errorResults,onDismiss:d=>I(d),onAction:()=>{s.categoryId&&x(`/dashboard/${s.categoryId}?control=${encodeURIComponent(s.controlId)}`)}},`${s.id}-${s.controlId}`))]})]})})});export{ys as default,js as meta};
