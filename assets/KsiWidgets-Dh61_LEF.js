import{a as L,R as Ne,p as e,q as wr,B as Zr,A as qr}from"./chunk-C37GKA54-CG9TNitP.js";import{a3 as Xr,H as Cr,l as Ue,m as Oe,x as Ze,a4 as Sr,a5 as kr,a6 as fr,a7 as Yr,U as ir,a8 as Ir,a9 as Jr,n as Nr,y as cr,A as Qr,F as dr,u as Rr,E as Me,B as ge,r as nr,a2 as et,j as rt,v as tt,Q as Tr,W as zr,K as Ar,z as at,G as Dr,S as N,T as p,J as I,Y as qe,L as Ee,R as $e,V as ue,N as Le,Z as _e}from"./dashboardStore-j1afM62Q.js";import{M as it,B as Y,I as nt}from"./IconSettings-CTxfJ391.js";import{T as te,S as Ie,I as st}from"./IconCheck-BdoyRWHd.js";import{C as Z,S as ot}from"./Select-CheMonxa.js";import{S as Be,T as lt}from"./IconHelp-BOZOBTM8.js";import{A as ct,H as oe,S as rr}from"./HelpIcon-C1bK2S4u.js";import{c as Ge,C as dt,R as ut,P as ht,a as mt,T as ft,I as ur}from"./PieChart-e3iealr6.js";function gt(r={timeout:2e3}){const[t,a]=L.useState(null),[i,n]=L.useState(!1),[s,c]=L.useState(null),d=k=>{window.clearTimeout(s),c(window.setTimeout(()=>n(!1),r.timeout)),n(k)};return{copy:k=>{"clipboard"in navigator?navigator.clipboard.writeText(k).then(()=>d(!0)).catch(b=>a(b)):a(new Error("useClipboard: navigator.clipboard is not supported"))},reset:()=>{n(!1),a(null),window.clearTimeout(s)},error:t,copied:i}}function pt(r,t={getInitialValueInEffect:!0}){const a=Xr(r,t),{colorScheme:i}=Cr();return i==="auto"?a:i}function Vr(r,t){var a={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(a[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(a[i[n]]=r[i[n]]);return a}var Fe;(function(r){r.event="event",r.props="prop"})(Fe||(Fe={}));function je(){}function vt(r){var t,a=void 0;return function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];return t&&i.length===t.length&&i.every(function(s,c){return s===t[c]})||(t=i,a=r.apply(void 0,i)),a}}function Ke(r){return!!(r||"").match(/\d/)}function Te(r){return r==null}function xt(r){return typeof r=="number"&&isNaN(r)}function Br(r){return Te(r)||xt(r)||typeof r=="number"&&!isFinite(r)}function Er(r){return r.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function jt(r){switch(r){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function yt(r,t,a){var i=jt(a),n=r.search(/[1-9]/);return n=n===-1?r.length:n,r.substring(0,n)+r.substring(n,r.length).replace(i,"$1"+t)}function bt(r){var t=L.useRef(r);t.current=r;var a=L.useRef(function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];return t.current.apply(t,i)});return a.current}function hr(r,t){t===void 0&&(t=!0);var a=r[0]==="-",i=a&&t;r=r.replace("-","");var n=r.split("."),s=n[0],c=n[1]||"";return{beforeDecimal:s,afterDecimal:c,hasNegation:a,addNegation:i}}function wt(r){if(!r)return r;var t=r[0]==="-";t&&(r=r.substring(1,r.length));var a=r.split("."),i=a[0].replace(/^0+/,"")||"0",n=a[1]||"";return(t?"-":"")+i+(n?"."+n:"")}function _r(r,t,a){for(var i="",n=a?"0":"",s=0;s<=t-1;s++)i+=r[s]||n;return i}function gr(r,t){return Array(t+1).join(r)}function Pr(r){var t=r+"",a=t[0]==="-"?"-":"";a&&(t=t.substring(1));var i=t.split(/[eE]/g),n=i[0],s=i[1];if(s=Number(s),!s)return a+n;n=n.replace(".","");var c=1+s,d=n.length;return c<0?n="0."+gr("0",Math.abs(c))+n:c>=d?n=n+gr("0",c-d):n=(n.substring(0,c)||"0")+"."+n.substring(c),a+n}function pr(r,t,a){if(["","-"].indexOf(r)!==-1)return r;var i=(r.indexOf(".")!==-1||a)&&t,n=hr(r),s=n.beforeDecimal,c=n.afterDecimal,d=n.hasNegation,o=parseFloat("0."+(c||"0")),u=c.length<=t?"0."+c:o.toFixed(t),k=u.split("."),b=s;s&&Number(k[0])&&(b=s.split("").reverse().reduce(function(z,g,h){return z.length>h?(Number(z[0])+Number(g)).toString()+z.substring(1,z.length):g+z},k[0]));var j=_r(k[1]||"",t,a),l=d?"-":"",m=i?".":"";return""+l+b+m+j}function Ce(r,t){if(r.value=r.value,r!==null){if(r.createTextRange){var a=r.createTextRange();return a.move("character",t),a.select(),!0}return r.selectionStart||r.selectionStart===0?(r.focus(),r.setSelectionRange(t,t),!0):(r.focus(),!1)}}var Mr=vt(function(r,t){for(var a=0,i=0,n=r.length,s=t.length;r[a]===t[a]&&a<n;)a++;for(;r[n-1-i]===t[s-1-i]&&s-i>a&&n-i>a;)i++;return{from:{start:a,end:n-i},to:{start:a,end:s-i}}}),Ct=function(r,t){var a=Math.min(r.selectionStart,t);return{from:{start:a,end:r.selectionEnd},to:{start:a,end:t}}};function St(r,t,a){return Math.min(Math.max(r,t),a)}function tr(r){return Math.max(r.selectionStart,r.selectionEnd)}function kt(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function It(r){return{from:{start:0,end:0},to:{start:0,end:r.length},lastValue:""}}function Nt(r){var t=r.currentValue,a=r.formattedValue,i=r.currentValueIndex,n=r.formattedValueIndex;return t[i]===a[n]}function Rt(r,t,a,i,n,s,c){c===void 0&&(c=Nt);var d=n.findIndex(function(_){return _}),o=r.slice(0,d);!t&&!a.startsWith(o)&&(t=o,a=o+a,i=i+o.length);for(var u=a.length,k=r.length,b={},j=new Array(u),l=0;l<u;l++){j[l]=-1;for(var m=0,z=k;m<z;m++){var g=c({currentValue:a,lastValue:t,formattedValue:r,currentValueIndex:l,formattedValueIndex:m});if(g&&b[m]!==!0){j[l]=m,b[m]=!0;break}}}for(var h=i;h<u&&(j[h]===-1||!s(a[h]));)h++;var f=h===u||j[h]===-1?k:j[h];for(h=i-1;h>0&&j[h]===-1;)h--;var A=h===-1||j[h]===-1?0:j[h]+1;return A>f?f:i-A<f-i?A:f}function vr(r,t,a,i){var n=r.length;if(t=St(t,0,n),i==="left"){for(;t>=0&&!a[t];)t--;t===-1&&(t=a.indexOf(!0))}else{for(;t<=n&&!a[t];)t++;t>n&&(t=a.lastIndexOf(!0))}return t===-1&&(t=n),t}function Tt(r){for(var t=Array.from({length:r.length+1}).map(function(){return!0}),a=0,i=t.length;a<i;a++)t[a]=!!(Ke(r[a])||Ke(r[a-1]));return t}function Lr(r,t,a,i,n,s){s===void 0&&(s=je);var c=bt(function(m,z){var g,h;return Br(m)?(h="",g=""):typeof m=="number"||z?(h=typeof m=="number"?Pr(m):m,g=i(h)):(h=n(m,void 0),g=i(h)),{formattedValue:g,numAsString:h}}),d=L.useState(function(){return c(Te(r)?t:r,a)}),o=d[0],u=d[1],k=function(m,z){m.formattedValue!==o.formattedValue&&u({formattedValue:m.formattedValue,numAsString:m.value}),s(m,z)},b=r,j=a;Te(r)&&(b=o.numAsString,j=!0);var l=c(b,j);return L.useMemo(function(){u(l)},[l.formattedValue]),[o,k]}function zt(r){return r.replace(/[^0-9]/g,"")}function At(r){return r}function Dt(r){var t=r.type;t===void 0&&(t="text");var a=r.displayType;a===void 0&&(a="input");var i=r.customInput,n=r.renderText,s=r.getInputRef,c=r.format;c===void 0&&(c=At);var d=r.removeFormatting;d===void 0&&(d=zt);var o=r.defaultValue,u=r.valueIsNumericString,k=r.onValueChange,b=r.isAllowed,j=r.onChange;j===void 0&&(j=je);var l=r.onKeyDown;l===void 0&&(l=je);var m=r.onMouseUp;m===void 0&&(m=je);var z=r.onFocus;z===void 0&&(z=je);var g=r.onBlur;g===void 0&&(g=je);var h=r.value,f=r.getCaretBoundary;f===void 0&&(f=Tt);var A=r.isValidInputCharacter;A===void 0&&(A=Ke);var _=r.isCharacterSame,V=Vr(r,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),W=Lr(h,o,!!u,c,d,k),$=W[0],D=$.formattedValue,F=$.numAsString,U=W[1],X=L.useRef(),J=L.useRef({formattedValue:D,numAsString:F}),M=function(v,y){J.current={formattedValue:v.formattedValue,numAsString:v.value},U(v,y)},ae=L.useState(!1),Q=ae[0],C=ae[1],S=L.useRef(null),E=L.useRef({setCaretTimeout:null,focusTimeout:null});L.useEffect(function(){return C(!0),function(){clearTimeout(E.current.setCaretTimeout),clearTimeout(E.current.focusTimeout)}},[]);var G=c,K=function(v,y){var R=parseFloat(y);return{formattedValue:v,value:y,floatValue:isNaN(R)?void 0:R}},T=function(v,y,R){v.selectionStart===0&&v.selectionEnd===v.value.length||(Ce(v,y),E.current.setCaretTimeout=setTimeout(function(){v.value===R&&v.selectionStart!==y&&Ce(v,y)},0))},q=function(v,y,R){return vr(v,y,f(v),R)},ie=function(v,y,R){var O=f(y),ee=Rt(y,D,v,R,O,A,_);return ee=vr(y,ee,O),ee},pe=function(v){var y=v.formattedValue;y===void 0&&(y="");var R=v.input,O=v.source,ee=v.event,H=v.numAsString,B;if(R){var se=v.inputValue||R.value,x=tr(R);R.value=y,B=ie(se,y,x),B!==void 0&&T(R,B,y)}y!==D&&M(K(y,H),{event:ee,source:O})};L.useEffect(function(){var v=J.current,y=v.formattedValue,R=v.numAsString;(D!==y||F!==R)&&M(K(D,F),{event:void 0,source:Fe.props})},[D,F]);var le=S.current?tr(S.current):void 0,P=typeof window<"u"?L.useLayoutEffect:L.useEffect;P(function(){var v=S.current;if(D!==J.current.formattedValue&&v){var y=ie(J.current.formattedValue,D,le);v.value=D,T(v,y,D)}},[D]);var ve=function(v,y,R){var O=y.target,ee=X.current?Ct(X.current,O.selectionEnd):Mr(D,v),H=Object.assign(Object.assign({},ee),{lastValue:D}),B=d(v,H),se=G(B);if(B=d(se,void 0),b&&!b(K(se,B))){var x=y.target,w=tr(x),re=ie(v,D,w);return x.value=D,T(x,re,D),!1}return pe({formattedValue:se,numAsString:B,inputValue:v,event:y,source:R,input:y.target}),!0},ke=function(v,y){y===void 0&&(y=0);var R=v.selectionStart,O=v.selectionEnd;X.current={selectionStart:R,selectionEnd:O+y}},he=function(v){var y=v.target,R=y.value,O=ve(R,v,Fe.event);O&&j(v),X.current=void 0},be=function(v){var y=v.target,R=v.key,O=y.selectionStart,ee=y.selectionEnd,H=y.value;H===void 0&&(H="");var B;R==="ArrowLeft"||R==="Backspace"?B=Math.max(O-1,0):R==="ArrowRight"?B=Math.min(O+1,H.length):R==="Delete"&&(B=O);var se=0;R==="Delete"&&O===ee&&(se=1);var x=R==="ArrowLeft"||R==="ArrowRight";if(B===void 0||O!==ee&&!x){l(v),ke(y,se);return}var w=B;if(x){var re=R==="ArrowLeft"?"left":"right";w=q(H,B,re),w!==B&&v.preventDefault()}else R==="Delete"&&!A(H[B])?w=q(H,B,"right"):R==="Backspace"&&!A(H[B])&&(w=q(H,B,"left"));w!==B&&T(y,w,H),l(v),ke(y,se)},Ae=function(v){var y=v.target,R=function(){var O=y.selectionStart,ee=y.selectionEnd,H=y.value;if(H===void 0&&(H=""),O===ee){var B=q(H,O);B!==O&&T(y,B,H)}};R(),requestAnimationFrame(function(){R()}),m(v),ke(y)},er=function(v){v.persist&&v.persist();var y=v.target,R=v.currentTarget;S.current=y,E.current.focusTimeout=setTimeout(function(){var O=y.selectionStart,ee=y.selectionEnd,H=y.value;H===void 0&&(H="");var B=q(H,O);B!==O&&!(O===0&&ee===H.length)&&T(y,B,H),z(Object.assign(Object.assign({},v),{currentTarget:R}))},0)},we=function(v){S.current=null,clearTimeout(E.current.focusTimeout),clearTimeout(E.current.setCaretTimeout),g(v)},De=Q&&kt()?"numeric":void 0,ne=Object.assign({inputMode:De},V,{type:t,value:D,onChange:he,onKeyDown:be,onMouseUp:Ae,onFocus:er,onBlur:we});if(a==="text")return n?Ne.createElement(Ne.Fragment,null,n(D,V)||null):Ne.createElement("span",Object.assign({},V,{ref:s}),D);if(i){var ce=i;return Ne.createElement(ce,Object.assign({},ne,{ref:s}))}return Ne.createElement("input",Object.assign({},ne,{ref:s}))}function xr(r,t){var a=t.decimalScale,i=t.fixedDecimalScale,n=t.prefix;n===void 0&&(n="");var s=t.suffix;s===void 0&&(s="");var c=t.allowNegative,d=t.thousandsGroupStyle;if(d===void 0&&(d="thousand"),r===""||r==="-")return r;var o=Xe(t),u=o.thousandSeparator,k=o.decimalSeparator,b=a!==0&&r.indexOf(".")!==-1||a&&i,j=hr(r,c),l=j.beforeDecimal,m=j.afterDecimal,z=j.addNegation;return a!==void 0&&(m=_r(m,a,!!i)),u&&(l=yt(l,u,d)),n&&(l=n+l),s&&(m=m+s),z&&(l="-"+l),r=l+(b&&k||"")+m,r}function Xe(r){var t=r.decimalSeparator;t===void 0&&(t=".");var a=r.thousandSeparator,i=r.allowedDecimalSeparators;return a===!0&&(a=","),i||(i=[t,"."]),{decimalSeparator:t,thousandSeparator:a,allowedDecimalSeparators:i}}function Vt(r,t){r===void 0&&(r="");var a=new RegExp("(-)"),i=new RegExp("(-)(.)*(-)"),n=a.test(r),s=i.test(r);return r=r.replace(/-/g,""),n&&!s&&t&&(r="-"+r),r}function Bt(r,t){return new RegExp("(^-)|[0-9]|"+Er(r),"g")}function Et(r,t,a){return r===""?!0:!(t!=null&&t.match(/\d/))&&!(a!=null&&a.match(/\d/))&&typeof r=="string"&&!isNaN(Number(r))}function _t(r,t,a){var i;t===void 0&&(t=It(r));var n=a.allowNegative,s=a.prefix;s===void 0&&(s="");var c=a.suffix;c===void 0&&(c="");var d=a.decimalScale,o=t.from,u=t.to,k=u.start,b=u.end,j=Xe(a),l=j.allowedDecimalSeparators,m=j.decimalSeparator,z=r[b]===m;if(Ke(r)&&(r===s||r===c)&&t.lastValue==="")return r;if(b-k===1&&l.indexOf(r[k])!==-1){var g=d===0?"":m;r=r.substring(0,k)+g+r.substring(k+1,r.length)}var h=function(S,E,G){var K=!1,T=!1;s.startsWith("-")?K=!1:S.startsWith("--")?(K=!1,T=!0):c.startsWith("-")&&S.length===c.length?K=!1:S[0]==="-"&&(K=!0);var q=K?1:0;return T&&(q=2),q&&(S=S.substring(q),E-=q,G-=q),{value:S,start:E,end:G,hasNegation:K}},f=h(r,k,b),A=f.hasNegation;i=f,r=i.value,k=i.start,b=i.end;var _=h(t.lastValue,o.start,o.end),V=_.start,W=_.end,$=_.value,D=r.substring(k,b);r.length&&$.length&&(V>$.length-c.length||W<s.length)&&!(D&&c.startsWith(D))&&(r=$);var F=0;r.startsWith(s)?F+=s.length:k<s.length&&(F=k),r=r.substring(F),b-=F;var U=r.length,X=r.length-c.length;r.endsWith(c)?U=X:(b>X||b>r.length-c.length)&&(U=b),r=r.substring(0,U),r=Vt(A?"-"+r:r,n),r=(r.match(Bt(m))||[]).join("");var J=r.indexOf(m);r=r.replace(new RegExp(Er(m),"g"),function(S,E){return E===J?".":""});var M=hr(r,n),ae=M.beforeDecimal,Q=M.afterDecimal,C=M.addNegation;return u.end-u.start<o.end-o.start&&ae===""&&z&&!parseFloat(Q)&&(r=C?"-":""),r}function Pt(r,t){var a=t.prefix;a===void 0&&(a="");var i=t.suffix;i===void 0&&(i="");var n=Array.from({length:r.length+1}).map(function(){return!0}),s=r[0]==="-";n.fill(!1,0,a.length+(s?1:0));var c=r.length;return n.fill(!1,c-i.length+1,c+1),n}function Mt(r){var t=Xe(r),a=t.thousandSeparator,i=t.decimalSeparator,n=r.prefix;n===void 0&&(n="");var s=r.allowNegative;if(s===void 0&&(s=!0),a===i)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+a+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+i+` (default value for decimalSeparator is .)
     `);return n.startsWith("-")&&s&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+n+`
      allowNegative: `+s+`
    `),s=!1),Object.assign(Object.assign({},r),{allowNegative:s})}function Lt(r){r=Mt(r),r.decimalSeparator,r.allowedDecimalSeparators,r.thousandsGroupStyle;var t=r.suffix,a=r.allowNegative,i=r.allowLeadingZeros,n=r.onKeyDown;n===void 0&&(n=je);var s=r.onBlur;s===void 0&&(s=je);var c=r.thousandSeparator,d=r.decimalScale,o=r.fixedDecimalScale,u=r.prefix;u===void 0&&(u="");var k=r.defaultValue,b=r.value,j=r.valueIsNumericString,l=r.onValueChange,m=Vr(r,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),z=Xe(r),g=z.decimalSeparator,h=z.allowedDecimalSeparators,f=function(C){return xr(C,r)},A=function(C,S){return _t(C,S,r)},_=Te(b)?k:b,V=j??Et(_,u,t);Te(b)?Te(k)||(V=V||typeof k=="number"):V=V||typeof b=="number";var W=function(C){return Br(C)?C:(typeof C=="number"&&(C=Pr(C)),V&&typeof d=="number"?pr(C,d,!!o):C)},$=Lr(W(b),W(k),!!V,f,A,l),D=$[0],F=D.numAsString,U=D.formattedValue,X=$[1],J=function(C){var S=C.target,E=C.key,G=S.selectionStart,K=S.selectionEnd,T=S.value;if(T===void 0&&(T=""),(E==="Backspace"||E==="Delete")&&K<u.length){C.preventDefault();return}if(G!==K){n(C);return}E==="Backspace"&&T[0]==="-"&&G===u.length+1&&a&&Ce(S,1),d&&o&&(E==="Backspace"&&T[G-1]===g?(Ce(S,G-1),C.preventDefault()):E==="Delete"&&T[G]===g&&C.preventDefault()),h!=null&&h.includes(E)&&T[G]===g&&Ce(S,G+1);var q=c===!0?",":c;E==="Backspace"&&T[G-1]===q&&Ce(S,G-1),E==="Delete"&&T[G]===q&&Ce(S,G+1),n(C)},M=function(C){var S=F;if(S.match(/\d/g)||(S=""),i||(S=wt(S)),o&&d&&(S=pr(S,d,o)),S!==F){var E=xr(S,r);X({formattedValue:E,value:S,floatValue:parseFloat(S)},{event:C,source:Fe.event})}s(C)},ae=function(C){return C===g?!0:Ke(C)},Q=function(C){var S=C.currentValue,E=C.lastValue,G=C.formattedValue,K=C.currentValueIndex,T=C.formattedValueIndex,q=S[K],ie=G[T],pe=Mr(E,S),le=pe.to,P=function(ve){return A(ve).indexOf(".")+u.length};return b===0&&o&&d&&S[le.start]===g&&P(S)<K&&P(G)>T?!1:K>=le.start&&K<le.end&&h&&h.includes(q)&&ie===g?!0:q===ie};return Object.assign(Object.assign({},m),{value:U,valueIsNumericString:!1,isValidInputCharacter:ae,isCharacterSame:Q,onValueChange:X,format:f,removeFormatting:A,getCaretBoundary:function(C){return Pt(C,r)},onKeyDown:J,onBlur:M})}function Ft(r){var t=Lt(r);return Ne.createElement(Dt,Object.assign({},t))}function jr({direction:r,style:t,...a}){return e.jsx("svg",{style:{width:"var(--ni-chevron-size)",height:"var(--ni-chevron-size)",transform:r==="up"?"rotate(180deg)":void 0,...t},viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:e.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var sr={root:"m_e2f5cd4e",controls:"m_95e17d22",control:"m_80b4b171"};const Kt=/^(0\.0*|-0(\.0*)?)$/,Ot=/^-?0\d+(\.\d+)?\.?$/;function or(r){return typeof r=="string"&&r!==""&&!Number.isNaN(Number(r))}function ar(r){return typeof r=="number"?r<Number.MAX_SAFE_INTEGER:r===""||or(r)&&Number(r)<Number.MAX_SAFE_INTEGER}function Ht(r){return r.toString().replace(".","").length}function $t(r,t){return(typeof r=="number"?r<Number.MAX_SAFE_INTEGER:!Number.isNaN(Number(r)))&&!Number.isNaN(r)&&Ht(t)<14&&t!==""}function yr(r,t,a){if(r===void 0)return!0;const i=t===void 0||r>=t,n=a===void 0||r<=a;return i&&n}const Gt={step:1,clampBehavior:"blur",allowDecimal:!0,allowNegative:!0,withKeyboardEvents:!0,allowLeadingZeros:!0,trimLeadingZeroesOnBlur:!0,startValue:0},Wt=cr((r,{size:t})=>({controls:{"--ni-chevron-size":Qr(t,"ni-chevron-size")}}));function Ut(r,t,a){const i=r.toString().replace(/^0+/,""),n=parseFloat(i);return Number.isNaN(n)?i:n>Number.MAX_SAFE_INTEGER?t!==void 0?String(t):i:Ge(n,a,t)}const fe=Ue((r,t)=>{const a=Oe("NumberInput",Gt,r),{className:i,classNames:n,styles:s,unstyled:c,vars:d,onChange:o,onValueChange:u,value:k,defaultValue:b,max:j,min:l,step:m,hideControls:z,rightSection:g,isAllowed:h,clampBehavior:f,onBlur:A,allowDecimal:_,decimalScale:V,onKeyDown:W,onKeyDownCapture:$,handlersRef:D,startValue:F,disabled:U,rightSectionPointerEvents:X,allowNegative:J,readOnly:M,size:ae,rightSectionWidth:Q,stepHoldInterval:C,stepHoldDelay:S,allowLeadingZeros:E,withKeyboardEvents:G,trimLeadingZeroesOnBlur:K,attributes:T,...q}=a,ie=Ze({name:"NumberInput",classes:sr,props:a,classNames:n,styles:s,unstyled:c,attributes:T,vars:d,varsResolver:Wt}),{resolvedClassNames:pe,resolvedStyles:le}=Sr({classNames:n,styles:s,props:a}),[P,ve]=kr({value:k,defaultValue:b,finalValue:"",onChange:o}),ke=S!==void 0&&C!==void 0,he=L.useRef(null),be=L.useRef(null),Ae=L.useRef(0),er=(x,w)=>{w.source==="event"&&ve($t(x.floatValue,x.value)&&!Kt.test(x.value)&&!(E&&Ot.test(x.value))?x.floatValue:x.value),u==null||u(x,w)},we=x=>{const w=String(x).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return w?Math.max(0,(w[1]?w[1].length:0)-(w[2]?+w[2]:0)):0},De=x=>{he.current&&typeof x<"u"&&he.current.setSelectionRange(x,x)},ne=L.useRef(fr);ne.current=()=>{if(!ar(P))return;let x;const w=we(P),re=we(m),He=Math.max(w,re),me=10**He;if(!or(P)&&(typeof P!="number"||Number.isNaN(P)))x=Ge(F,l,j);else if(j!==void 0){const de=(Math.round(Number(P)*me)+Math.round(m*me))/me;x=de<=j?de:j}else x=(Math.round(Number(P)*me)+Math.round(m*me))/me;const xe=x.toFixed(He);ve(parseFloat(xe)),u==null||u({floatValue:parseFloat(xe),formattedValue:xe,value:xe},{source:"increment"}),setTimeout(()=>{var de;return De((de=he.current)==null?void 0:de.value.length)},0)};const ce=L.useRef(fr);ce.current=()=>{if(!ar(P))return;let x;const w=l!==void 0?l:J?Number.MIN_SAFE_INTEGER:0,re=we(P),He=we(m),me=Math.max(re,He),xe=10**me;if(!or(P)&&typeof P!="number"||Number.isNaN(P))x=Ge(F,w,j);else{const Ve=(Math.round(Number(P)*xe)-Math.round(m*xe))/xe;x=w!==void 0&&Ve<w?w:Ve}const de=x.toFixed(me);ve(parseFloat(de)),u==null||u({floatValue:parseFloat(de),formattedValue:de,value:de},{source:"decrement"}),setTimeout(()=>{var Ve;return De((Ve=he.current)==null?void 0:Ve.value.length)},0)};const v=x=>{var w,re;W==null||W(x),!(M||!G)&&(x.key==="ArrowUp"&&(x.preventDefault(),(w=ne.current)==null||w.call(ne)),x.key==="ArrowDown"&&(x.preventDefault(),(re=ce.current)==null||re.call(ce)))},y=x=>{if($==null||$(x),x.key==="Backspace"){const w=he.current;w&&w.selectionStart===0&&w.selectionStart===w.selectionEnd&&(x.preventDefault(),window.setTimeout(()=>De(0),0))}},R=x=>{let w=P;f==="blur"&&typeof w=="number"&&(w=Ge(w,l,j)),K&&typeof w=="string"&&we(w)<15&&(w=Ut(w,j,l)),P!==w&&ve(w),A==null||A(x)};Yr(D,{increment:ne.current,decrement:ce.current});const O=x=>{var w,re;x?(w=ne.current)==null||w.call(ne):(re=ce.current)==null||re.call(ce),Ae.current+=1},ee=x=>{if(O(x),ke){const w=typeof C=="number"?C:C(Ae.current);be.current=window.setTimeout(()=>ee(x),w)}},H=(x,w)=>{var re;x.preventDefault(),(re=he.current)==null||re.focus(),O(w),ke&&(be.current=window.setTimeout(()=>ee(w),S))},B=()=>{be.current&&window.clearTimeout(be.current),be.current=null,Ae.current=0},se=e.jsxs("div",{...ie("controls"),children:[e.jsx(ir,{...ie("control"),tabIndex:-1,"aria-hidden":!0,disabled:U||typeof P=="number"&&j!==void 0&&P>=j,mod:{direction:"up"},onMouseDown:x=>x.preventDefault(),onPointerDown:x=>{H(x,!0)},onPointerUp:B,onPointerLeave:B,children:e.jsx(jr,{direction:"up"})}),e.jsx(ir,{...ie("control"),tabIndex:-1,"aria-hidden":!0,disabled:U||typeof P=="number"&&l!==void 0&&P<=l,mod:{direction:"down"},onMouseDown:x=>x.preventDefault(),onPointerDown:x=>{H(x,!1)},onPointerUp:B,onPointerLeave:B,children:e.jsx(jr,{direction:"down"})})]});return e.jsx(Ir,{component:Ft,allowNegative:J,className:Nr(sr.root,i),size:ae,...q,readOnly:M,disabled:U,value:P,getInputRef:Jr(t,he),onValueChange:er,rightSection:z||M||!ar(P)?g:g||se,classNames:pe,styles:le,unstyled:c,__staticSelector:"NumberInput",decimalScale:_?V:0,onKeyDown:v,onKeyDownCapture:y,rightSectionPointerEvents:X??(U?"none":void 0),rightSectionWidth:Q??`var(--ni-right-section-width-${ae||"sm"})`,allowLeadingZeros:E,onBlur:R,attributes:T,isAllowed:x=>f==="strict"?h?h(x)&&yr(x.floatValue,l,j):yr(x.floatValue,l,j):h?h(x):!0})});fe.classes={...Ir.classes,...sr};fe.displayName="@mantine/core/NumberInput";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],Fr=dr("outline","arrow-up-right","ArrowUpRight",Zt);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M3 5v14l8 -7z",key:"svg-0"}],["path",{d:"M14 5v14l8 -7z",key:"svg-1"}]],mr=dr("outline","player-track-next","PlayerTrackNext",qt);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M4.05 11a8 8 0 1 1 .5 4m-.5 5v-5h5",key:"svg-0"}]],Yt=dr("outline","rotate-clockwise","RotateClockwise",Xt);function Jt(r){return r?r.reduce((t,a)=>{const i=a.name.search(/\./);if(i>=0){const n=a.name.substring(i+1);return t[n]=a.label,t}return t[a.name]=a.label,t},{}):{}}var Qt={tooltip:"m_e4d36c9b",tooltipLabel:"m_7f4bcb19",tooltipBody:"m_3de554dd",tooltipItemColor:"m_b30369b5",tooltipItem:"m_3de8964e",tooltipItemBody:"m_50186d10",tooltipItemName:"m_501dadf9",tooltipItemData:"m_50192318"};function ea(r){return r.map(t=>{if(!t.payload||t.payload[t.name])return t;const a=t.name.search(/\./);if(a>=0){const i=t.name.substring(0,a),n={...t.payload[i]},s=Object.entries(t.payload).reduce((c,d)=>{const[o,u]=d;return o===i?c:{...c,[o]:u}},{});return{...t,name:t.name.substring(a+1),payload:{...s,...n}}}return t})}function ra(r,t){const a=ea(r.filter(i=>i.fill!=="none"||!i.color));return t?a.filter(i=>i.name===t):a}function br(r,t){return t==="radial"||t==="scatter"?Array.isArray(r.value)?r.value[1]-r.value[0]:r.value:Array.isArray(r.payload[r.dataKey])?r.payload[r.dataKey][1]-r.payload[r.dataKey][0]:r.payload[r.name]}const ta={type:"area",showColor:!0},Kr=Ue((r,t)=>{var X,J;const a=Oe("ChartTooltip",ta,r),{classNames:i,className:n,style:s,styles:c,unstyled:d,vars:o,payload:u,label:k,unit:b,type:j,segmentId:l,mod:m,series:z,valueFormatter:g,showColor:h,attributes:f,...A}=a,_=Rr(),V=Ze({name:"ChartTooltip",classes:Qt,props:a,className:n,style:s,classNames:i,styles:c,unstyled:d,attributes:f});if(!u)return null;const W=ra(u,l),$=j==="scatter"?(J=(X=u[0])==null?void 0:X.payload)==null?void 0:J.name:null,D=Jt(z),F=k||$,U=W.map(M=>e.jsxs("div",{"data-type":j,...V("tooltipItem"),children:[e.jsxs("div",{...V("tooltipItemBody"),children:[h&&e.jsx("svg",{...V("tooltipItemColor"),children:e.jsx("circle",{r:6,fill:Me(M.color,_),width:12,height:12,cx:6,cy:6})}),e.jsx("div",{...V("tooltipItemName"),children:D[M.name]||M.name})]}),e.jsxs("div",{...V("tooltipItemData"),children:[typeof g=="function"?g(br(M,j)):br(M,j),b||M.unit]})]},(M==null?void 0:M.key)??M.name));return e.jsxs(ge,{...V("tooltip"),mod:[{type:j},m],ref:t,...A,children:[F&&e.jsx("div",{...V("tooltipLabel"),children:F}),e.jsx("div",{...V("tooltipBody"),children:U})]})});Kr.displayName="@mantine/charts/ChartTooltip";var Or={root:"m_a410e613",label:"m_ddb0bfe3"};const aa={withTooltip:!0,withLabelsLine:!0,paddingAngle:0,thickness:20,size:160,strokeWidth:1,startAngle:0,endAngle:360,labelsType:"value",tooltipDataSource:"all"},ia=cr((r,{strokeColor:t,labelColor:a,withLabels:i,size:n})=>({root:{"--chart-stroke-color":t?Me(t,r):void 0,"--chart-labels-color":a?Me(a,r):void 0,"--chart-size":i?nr(n+80):nr(n)}})),na=(r,t,a,i)=>r==="percent"?`${((a||0)*100).toFixed(0)}%`:typeof i=="function"?i(t||0):t,sa=(r,t)=>({x:a,y:i,cx:n,cy:s,percent:c,value:d})=>e.jsx("text",{x:a,y:i,cx:n,cy:s,textAnchor:a>n?"start":"end",fill:"var(--chart-labels-color, var(--mantine-color-dimmed))",fontFamily:"var(--mantine-font-family)",fontSize:12,children:e.jsx("tspan",{x:a,children:na(r,d,c,t)})}),Ye=Ue((r,t)=>{const a=Oe("DonutChart",aa,r),{classNames:i,className:n,style:s,styles:c,unstyled:d,vars:o,data:u,withTooltip:k,tooltipAnimationDuration:b,tooltipProps:j,pieProps:l,paddingAngle:m,withLabels:z,withLabelsLine:g,size:h,thickness:f,strokeWidth:A,startAngle:_,endAngle:V,tooltipDataSource:W,chartLabel:$,children:D,pieChartProps:F,valueFormatter:U,strokeColor:X,labelsType:J,attributes:M,...ae}=a,Q=Rr(),C=Ze({name:"DonutChart",classes:Or,props:a,className:n,style:s,classNames:i,styles:c,unstyled:d,attributes:M,vars:o,varsResolver:ia}),{resolvedClassNames:S,resolvedStyles:E}=Sr({classNames:i,styles:c,props:a}),G=u.map((K,T)=>e.jsx(dt,{fill:Me(K.color,Q),stroke:"var(--chart-stroke-color, var(--mantine-color-body))",strokeWidth:A},T));return e.jsx(ge,{ref:t,size:h,...C("root"),...ae,children:e.jsx(ut,{children:e.jsxs(ht,{...F,children:[e.jsx(mt,{data:u,innerRadius:h/2-f,outerRadius:h/2,dataKey:"value",isAnimationActive:!1,paddingAngle:m,startAngle:_,endAngle:V,label:z?sa(J||"value",U):!1,labelLine:g?{stroke:"var(--chart-label-color, var(--mantine-color-dimmed))",strokeWidth:1}:!1,...l,children:G}),$&&e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",...C("label"),children:$}),k&&e.jsx(ft,{animationDuration:b,isAnimationActive:!1,content:({payload:K})=>{var T;return e.jsx(Kr,{payload:u,classNames:S,styles:E,type:"radial",segmentId:W==="segment"?(T=K==null?void 0:K[0])==null?void 0:T.name:void 0,valueFormatter:U,attributes:M})},...j}),D]})})})});Ye.displayName="@mantine/charts/DonutChart";Ye.classes=Or;const lr={getHighlighter:()=>({code:r})=>({highlightedCode:r,isHighlighted:!1})},[Ca,oa]=et({adapter:lr,highlight:lr.getHighlighter(null)});function la(){const r=oa();return(r==null?void 0:r.highlight)||lr.getHighlighter(null)}const[ca,da]=rt("CodeHighlightProvider was not found in the component tree"),Je=tt((r,t)=>{const a=Oe("CodeHighlightControl",null,r),{children:i,vars:n,tooltipLabel:s,...c}=a,d=da(),o=d.getStyles("controlTooltip"),u=e.jsx(Tr,{ref:t,...d.getStyles("control"),...c,variant:"none","data-code-color-scheme":d.codeColorScheme,children:i});return s?e.jsx(zr,{label:s,fz:"sm",position:"bottom",classNames:{tooltip:o.className},styles:{tooltip:o.style},"data-code-color-scheme":d.codeColorScheme,transitionProps:{duration:0},children:u}):u});Je.displayName="@mantine/code-highlight/CodeHighlightControl";function Hr({copied:r,...t}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...t,children:r?e.jsxs(e.Fragment,{children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M5 12l5 5l10 -10"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),e.jsx("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]})})}Hr.displayName="@mantine/code-highlight/CopyIcon";function $r({code:r,copyLabel:t="Copy",copiedLabel:a="Copied"}){const i=gt();return e.jsx(Je,{onClick:()=>i.copy(r.trim()),variant:"none",tooltipLabel:i.copied?a:t,"aria-label":i.copied?a:`${t} code`,children:e.jsx(Hr,{copied:i.copied})})}$r.displayName="@mantine/code-highlight/CopyCodeButton";function Gr({expanded:r,style:t,...a}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...a,children:r?e.jsxs(e.Fragment,{children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 13v-8l-3 3m6 0l-3 -3"}),e.jsx("path",{d:"M9 17l1 0"}),e.jsx("path",{d:"M14 17l1 0"}),e.jsx("path",{d:"M19 17l1 0"}),e.jsx("path",{d:"M4 17l1 0"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 11v8l3 -3m-6 0l3 3"}),e.jsx("path",{d:"M9 7l1 0"}),e.jsx("path",{d:"M14 7l1 0"}),e.jsx("path",{d:"M19 7l1 0"}),e.jsx("path",{d:"M4 7l1 0"})]})})}Gr.displayName="@mantine/code-highlight/ExpandIcon";function Wr({expanded:r,onExpand:t,expandCodeLabel:a="Expand code",collapseCodeLabel:i="Collapse code"}){return e.jsx(Je,{onClick:()=>t(!r),tooltipLabel:r?i:a,children:e.jsx(Gr,{expanded:r})})}Wr.displayName="@mantine/code-highlight/ExpandCodeButton";var Ur={root:"m_5cb1b9c8",codeHighlight:"m_e597c321",inlineCodeHighlight:"m_dfe9c588",pre:"m_2c47c4fd",code:"m_5caae6d3",controls:"m_be7e9c9c",control:"m_d498bab7",controlTooltip:"m_4c3d814c",scrollarea:"m_f744fd40",showCodeButton:"m_c9378bc2",file:"m_5cac2e62",fileIcon:"m_b46cddfb",filesScrollarea:"m_7b14120b",files:"m_38d99e51"};const ua={withCopyButton:!0,expandCodeLabel:"Expand code"},ha=cr((r,{maxCollapsedHeight:t,background:a,radius:i})=>({codeHighlight:{"--ch-max-height":nr(t),"--ch-background":a?Me(a,r):void 0,"--ch-radius":typeof i<"u"?at(i):void 0}})),Qe=Ue((r,t)=>{var ie,pe,le,P;const a=Oe("CodeHighlight",ua,r),{classNames:i,className:n,style:s,styles:c,unstyled:d,vars:o,code:u,copiedLabel:k,copyLabel:b,defaultExpanded:j,expanded:l,onExpandedChange:m,maxCollapsedHeight:z,withCopyButton:g,withExpandButton:h,expandCodeLabel:f,collapseCodeLabel:A,radius:_,background:V,withBorder:W,controls:$,language:D,codeColorScheme:F,__withOffset:U,__inline:X,__staticSelector:J,attributes:M,...ae}=a,Q=Ze({name:J||"CodeHighlight",classes:Ur,props:a,className:n,style:s,classNames:i,styles:c,unstyled:d,attributes:M,vars:o,varsResolver:ha,rootSelector:"codeHighlight"}),[C,S]=kr({value:l,defaultValue:j,finalValue:!0,onChange:m}),E=$&&$.length>0||h||g,G=pt(),T=la()({code:u.trim(),language:D,colorScheme:G}),q=T.isHighlighted?{dangerouslySetInnerHTML:{__html:T.highlightedCode}}:{children:u.trim()};return X?e.jsx(ge,{component:"code",ref:t,...ae,...T.codeElementProps,...Q("codeHighlight",{className:Nr((ie=T.codeElementProps)==null?void 0:ie.className,n),style:[{...(pe=T.codeElementProps)==null?void 0:pe.style},s]}),"data-with-border":W||void 0,...q}):e.jsx(ca,{value:{getStyles:Q,codeColorScheme:F},children:e.jsxs(ge,{ref:t,...Q("codeHighlight"),...ae,dir:"ltr","data-code-color-scheme":F,"data-with-border":W||void 0,children:[E&&e.jsxs("div",{...Q("controls"),"data-with-offset":U||void 0,children:[$,h&&e.jsx(Wr,{expanded:C,onExpand:S,expandCodeLabel:f,collapseCodeLabel:A}),g&&e.jsx($r,{code:u,copiedLabel:k,copyLabel:b})]}),e.jsx(Ar,{type:"hover",scrollbarSize:4,dir:"ltr",offsetScrollbars:!1,"data-collapsed":!C||void 0,styles:{viewport:{overscrollBehaviorInline:"none"}},...Q("scrollarea"),children:e.jsx("pre",{...Q("pre"),"data-with-offset":U||void 0,children:e.jsx("code",{...T.codeElementProps,...Q("code",{className:(le=T.codeElementProps)==null?void 0:le.className,style:(P=T.codeElementProps)==null?void 0:P.style}),...q})})}),e.jsx(ir,{...Q("showCodeButton"),mod:{hidden:C},onClick:()=>S(!0),"data-code-color-scheme":F,children:f})]})})});Qe.displayName="@mantine/code-highlight/CodeHighlight";Qe.classes=Ur;Qe.Control=Je;function ze(r){return r?(r.ok??0)+(r.alarm??0)+(r.error??0)+(r.skip??0)+(r.info??0):0}function Se(r){const t=ze(r);return t?100*((r==null?void 0:r.ok)??0)/t:0}function Pe(r){if(!r)return"";let t=r.replace(/^This benchmark assesses FedRAMP 20x KSIs for\s*/i,"");return t=t.replace(/^FedRAMP 20x Key Security Indicators \(KSIs\) for\s*/i,""),t=t.replace(/\s*based on infrastructure and application security controls\.?$/i,""),t=t.replace(/\s*with additional details\.?$/i,""),t.trim()}function ye(r){return r?r.replace(/^FedRAMP 20x Key Security Indicators \(KSIs\) for\s*/i,"").trim():""}function Sa(r){return r.map(t=>{var a,i,n;return{id:t.group_id,title:ye(t.title),description:Pe(t.description),status:(a=t.summary)==null?void 0:a.status,total:ze((i=t.summary)==null?void 0:i.status),okRate:Se((n=t.summary)==null?void 0:n.status),group:t}})}function ma({opened:r,onClose:t}){const{globalViewSettings:a,updateGlobalViewSettings:i,resetGlobalViewSettings:n}=Dr(),[s,c]=L.useState(a),[d,o]=L.useState(!1),u=l=>{const m={...s,...l,display:{...s.display,...l.display},riskConfig:{...s.riskConfig,...l.riskConfig},filtering:{...s.filtering,...l.filtering},visual:{...s.visual,...l.visual}};c(m),o(!0)},k=()=>{i(s),o(!1),t()},b=()=>{n(),c(a),o(!1)},j=()=>{c(a),o(!1),t()};return e.jsx(it,{opened:r,onClose:j,title:e.jsxs(I,{gap:"sm",children:[e.jsx(ue,{order:3,children:"Global View Settings"}),d&&e.jsx(Y,{color:"blue",variant:"light",children:"Unsaved changes"})]}),size:"xl",padding:"md",children:e.jsxs(N,{gap:"lg",children:[e.jsxs(te,{defaultValue:"display",variant:"outline",children:[e.jsxs(te.List,{children:[e.jsx(te.Tab,{value:"display",children:"Display"}),e.jsx(te.Tab,{value:"risk",children:"Risk Config"}),e.jsx(te.Tab,{value:"filtering",children:"Filtering"}),e.jsx(te.Tab,{value:"visual",children:"Visual"})]}),e.jsx(te.Panel,{value:"display",pt:"md",children:e.jsxs(N,{gap:"md",children:[e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Layout & Content"}),e.jsxs(I,{justify:"space-between",children:[e.jsx(p,{size:"sm",children:"Priority Actions Count"}),e.jsx(ot,{w:120,value:s.display.priorityActionsCount.toString(),data:[{value:"3",label:"3 items"},{value:"5",label:"5 items"},{value:"10",label:"10 items"},{value:"15",label:"15 items"}],onChange:l=>u({display:{priorityActionsCount:parseInt(l||"5")}})})]}),e.jsxs(I,{justify:"space-between",children:[e.jsx(p,{size:"sm",children:"View Density"}),e.jsx(Be,{value:s.display.viewDensity,data:[{value:"compact",label:"Compact"},{value:"normal",label:"Normal"},{value:"spacious",label:"Spacious"}],onChange:l=>u({display:{viewDensity:l}})})]}),e.jsxs(I,{justify:"space-between",children:[e.jsx(p,{size:"sm",children:"Chart Size"}),e.jsx(Be,{value:s.display.chartSize,data:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}],onChange:l=>u({display:{chartSize:l}})})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Section Visibility"}),e.jsx(Ie,{label:"Show Priority Actions",description:"Display the top critical KSI families requiring attention",checked:s.display.showPriorityActions,onChange:l=>u({display:{showPriorityActions:l.currentTarget.checked}})}),e.jsx(Ie,{label:"Show Risk Assessment Grid",description:"Display the visual risk overview of all KSI families",checked:s.display.showRiskAssessment,onChange:l=>u({display:{showRiskAssessment:l.currentTarget.checked}})}),e.jsx(Ie,{label:"Show Detailed Statistics by Default",description:"Expand detailed charts and metrics section automatically",checked:s.display.showDetailedStats,onChange:l=>u({display:{showDetailedStats:l.currentTarget.checked}})})]})})]})}),e.jsx(te.Panel,{value:"risk",pt:"md",children:e.jsxs(N,{gap:"md",children:[e.jsx(ct,{icon:e.jsx(qe,{size:16}),color:"blue",variant:"light",children:"Configure thresholds to define risk levels and compliance ratings. Percentages are based on (problems/total checks) for risk and (OK checks/total) for compliance."}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Risk Level Thresholds"}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,children:"High Risk Threshold"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["KSI Families with ≥",s.riskConfig.highRiskThreshold,"% problems"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.highRiskThreshold,onChange:l=>u({riskConfig:{highRiskThreshold:typeof l=="number"?l:30}}),min:1,max:100,suffix:"%"})]}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,children:"Medium Risk Threshold"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["KSI Families with ≥",s.riskConfig.mediumRiskThreshold,"% problems"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.mediumRiskThreshold,onChange:l=>u({riskConfig:{mediumRiskThreshold:typeof l=="number"?l:10}}),min:1,max:s.riskConfig.highRiskThreshold-1,suffix:"%"})]}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,children:"Low Risk Threshold"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["KSI Families with ≥",s.riskConfig.lowRiskThreshold,"% problems"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.lowRiskThreshold,onChange:l=>u({riskConfig:{lowRiskThreshold:typeof l=="number"?l:1}}),min:0,max:s.riskConfig.mediumRiskThreshold-1,suffix:"%"})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Compliance Rate KSI Families"}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,c:"teal",children:"Excellent"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["≥",s.riskConfig.excellentComplianceRate,"% OK rate"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.excellentComplianceRate,onChange:l=>u({riskConfig:{excellentComplianceRate:typeof l=="number"?l:95}}),min:s.riskConfig.goodComplianceRate+1,max:100,suffix:"%"})]}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,c:"green",children:"Good"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["≥",s.riskConfig.goodComplianceRate,"% OK rate"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.goodComplianceRate,onChange:l=>u({riskConfig:{goodComplianceRate:typeof l=="number"?l:90}}),min:s.riskConfig.fairComplianceRate+1,max:s.riskConfig.excellentComplianceRate-1,suffix:"%"})]}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,c:"yellow",children:"Fair"}),e.jsxs(p,{size:"xs",c:"dimmed",children:["≥",s.riskConfig.fairComplianceRate,"% OK rate"]})]}),e.jsx(fe,{w:80,value:s.riskConfig.fairComplianceRate,onChange:l=>u({riskConfig:{fairComplianceRate:typeof l=="number"?l:75}}),min:1,max:s.riskConfig.goodComplianceRate-1,suffix:"%"})]})]})})]})}),e.jsx(te.Panel,{value:"filtering",pt:"md",children:e.jsxs(N,{gap:"md",children:[e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Quick Filters"}),e.jsx(Ie,{label:"Hide KSI Families with Zero Issues",description:"Only show KSI Families that have alarms, errors, or other problems",checked:s.filtering.hideZeroIssueCategories,onChange:l=>u({filtering:{hideZeroIssueCategories:l.currentTarget.checked}})}),e.jsx(Ie,{label:"Show Only Critical KSI Families",description:"Display only KSI Families with alarms or errors",checked:s.filtering.showOnlyCritical,onChange:l=>u({filtering:{showOnlyCritical:l.currentTarget.checked}})}),e.jsxs(I,{justify:"space-between",children:[e.jsxs("div",{children:[e.jsx(p,{size:"sm",fw:500,children:"Minimum Compliance Threshold"}),e.jsx(p,{size:"xs",c:"dimmed",children:"Hide KSI families above this compliance rate"})]}),e.jsx(fe,{w:80,value:s.filtering.minimumComplianceThreshold,onChange:l=>u({filtering:{minimumComplianceThreshold:typeof l=="number"?l:0}}),min:0,max:100,suffix:"%"})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"KSI Family Exclusions"}),e.jsx(p,{size:"xs",c:"dimmed",children:"KSI Families excluded from Global View analysis (coming soon)"}),e.jsx(p,{size:"xs",c:"gray",fs:"italic",children:"Feature will be available once category management is implemented"})]})})]})}),e.jsx(te.Panel,{value:"visual",pt:"md",children:e.jsxs(N,{gap:"md",children:[e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Color Theme"}),e.jsx(Be,{value:s.visual.colorTheme,data:[{value:"default",label:"Default"},{value:"high-contrast",label:"High Contrast"},{value:"colorblind-friendly",label:"Colorblind Friendly"}],onChange:l=>u({visual:{colorTheme:l}})})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsx(p,{fw:500,size:"sm",children:"Alert & Progress Styles"}),e.jsxs(I,{justify:"space-between",children:[e.jsx(p,{size:"sm",children:"Alert Banner Style"}),e.jsx(Be,{value:s.visual.alertStyle,data:[{value:"banner",label:"Banner"},{value:"inline",label:"Inline"},{value:"minimal",label:"Minimal"}],onChange:l=>u({visual:{alertStyle:l}})})]}),e.jsxs(I,{justify:"space-between",children:[e.jsx(p,{size:"sm",children:"Progress Bar Style"}),e.jsx(Be,{value:s.visual.progressBarStyle,data:[{value:"standard",label:"Standard"},{value:"thin",label:"Thin"},{value:"segmented",label:"Segmented"}],onChange:l=>u({visual:{progressBarStyle:l}})})]}),e.jsx(Ie,{label:"Enable Animations",description:"Show hover effects and smooth transitions",checked:s.visual.enableAnimations,onChange:l=>u({visual:{enableAnimations:l.currentTarget.checked}})})]})})]})})]}),e.jsx(Ee,{}),e.jsxs(I,{justify:"space-between",children:[e.jsx($e,{variant:"light",color:"gray",leftSection:e.jsx(Yt,{size:16}),onClick:b,children:"Reset to Defaults"}),e.jsxs(I,{gap:"sm",children:[e.jsx($e,{variant:"subtle",onClick:j,children:"Cancel"}),e.jsx($e,{leftSection:e.jsx(st,{size:16}),onClick:k,disabled:!d,children:"Save Changes"})]})]})]})})}const Re=new Intl.NumberFormat("en-US");function fa({status:r,height:t=20,radius:a=10}){const i=r||{},n=ze(i);if(n===0)return e.jsx(ge,{style:{height:t,borderRadius:a,backgroundColor:"var(--mantine-color-gray-2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(p,{size:"sm",c:"dimmed",children:"No data"})});const s=[{key:"ok",value:i.ok??0,color:"var(--mantine-color-teal-6)",label:"OK",icon:ur},{key:"alarm",value:i.alarm??0,color:"var(--mantine-color-red-6)",label:"Alarm",icon:Le},{key:"error",value:i.error??0,color:"var(--mantine-color-grape-6)",label:"Error",icon:_e},{key:"skip",value:i.skip??0,color:"var(--mantine-color-gray-6)",label:"Skip",icon:mr},{key:"info",value:i.info??0,color:"var(--mantine-color-blue-6)",label:"Info",icon:qe}].filter(c=>c.value>0);return e.jsx(ge,{style:{height:t,borderRadius:a,backgroundColor:"var(--mantine-color-gray-2)",display:"flex",overflow:"hidden",cursor:"help"},role:"progressbar","aria-label":`Status breakdown: ${s.map(c=>`${c.label} ${c.value}`).join(", ")}`,children:s.map((c,d)=>{const o=c.value/n*100,u=d===0,k=d===s.length-1;return e.jsx(zr,{label:e.jsxs("div",{children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(c.icon,{size:14}),e.jsx(p,{size:"sm",fw:500,children:c.label})]}),e.jsxs(p,{size:"sm",children:[Re.format(c.value)," (",o.toFixed(1),"%)"]})]}),position:"top",withArrow:!0,children:e.jsx(ge,{style:{flex:`0 0 ${o}%`,backgroundColor:c.color,height:"100%",borderTopLeftRadius:u?a:0,borderBottomLeftRadius:u?a:0,borderTopRightRadius:k?a:0,borderBottomRightRadius:k?a:0,transition:"all 0.3s ease",cursor:"help"},onMouseEnter:b=>{b.currentTarget.style.opacity="0.8",b.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:b=>{b.currentTarget.style.opacity="1",b.currentTarget.style.transform="translateY(0)"}})},c.key)})})}function We({status:r}){const t=r||{},a=[{label:"OK",value:t.ok??0,color:"teal",icon:ur},{label:"Alarm",value:t.alarm??0,color:"red",icon:Le},{label:"Error",value:t.error??0,color:"grape",icon:_e},{label:"Skip",value:t.skip??0,color:"gray",icon:mr},{label:"Info",value:t.info??0,color:"blue",icon:qe}];return e.jsx(I,{gap:"xs",wrap:"wrap",children:a.map(i=>e.jsxs(Y,{color:i.color,variant:"light",leftSection:e.jsx(i.icon,{size:14}),children:[i.label,": ",i.value]},i.label))})}function ka({categories:r,onFocusCategory:t}){const a=wr(),{globalViewSettings:i}=Dr(),[n,s]=L.useState(!1),{colorScheme:c}=Cr(),d=L.useMemo(()=>r.filter(g=>{var _;const h=(_=g.summary)==null?void 0:_.status,f=((h==null?void 0:h.alarm)??0)+((h==null?void 0:h.error)??0),A=Math.round(Se(h));return!(i.filtering.hideZeroIssueCategories&&f===0||i.filtering.showOnlyCritical&&f===0||i.filtering.minimumComplianceThreshold>0&&A>i.filtering.minimumComplianceThreshold)}),[r,i.filtering]),o=L.useMemo(()=>d.reduce((g,h)=>{var A;const f=(A=h.summary)==null?void 0:A.status;return{ok:(g.ok??0)+((f==null?void 0:f.ok)??0),alarm:(g.alarm??0)+((f==null?void 0:f.alarm)??0),error:(g.error??0)+((f==null?void 0:f.error)??0),skip:(g.skip??0)+((f==null?void 0:f.skip)??0),info:(g.info??0)+((f==null?void 0:f.info)??0)}},{}),[d]),u=L.useMemo(()=>d.filter(g=>{var f;const h=(f=g.summary)==null?void 0:f.status;return((h==null?void 0:h.alarm)??0)>0||((h==null?void 0:h.error)??0)>0}).sort((g,h)=>{var _,V,W,$,D,F,U,X;const f=(((V=(_=g.summary)==null?void 0:_.status)==null?void 0:V.alarm)??0)+((($=(W=g.summary)==null?void 0:W.status)==null?void 0:$.error)??0);return(((F=(D=h.summary)==null?void 0:D.status)==null?void 0:F.alarm)??0)+(((X=(U=h.summary)==null?void 0:U.status)==null?void 0:X.error)??0)-f}).slice(0,i.display.priorityActionsCount),[d,i.display.priorityActionsCount]),k=L.useMemo(()=>d.map(g=>{var W;const h=(W=g.summary)==null?void 0:W.status,f=ze(h),A=((h==null?void 0:h.alarm)??0)+((h==null?void 0:h.error)??0),_=f===0?0:A/f*100;let V="safe";return _>=i.riskConfig.highRiskThreshold?V="high":_>=i.riskConfig.mediumRiskThreshold?V="medium":_>=i.riskConfig.lowRiskThreshold&&(V="low"),{id:g.group_id,title:g.title,total:f,problems:A,riskLevel:_,riskCategory:V,okRate:Math.round(Se(h)),status:h}}).sort((g,h)=>h.riskLevel-g.riskLevel),[d,i.riskConfig]),b=ze(o),j=Math.round(Se(o)),l=(o.alarm??0)+(o.error??0),m=u.length,z=g=>{switch(g){case"high":return"red";case"medium":return"orange";case"low":return"yellow";default:return"teal"}};return e.jsx(Z,{withBorder:!0,padding:"lg",radius:"md",children:e.jsxs(N,{gap:"lg",children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(ue,{order:3,children:"KSI Compliance Overview"}),e.jsx(oe,{tooltip:"This overview uses aggregated summary totals reported by each KSI family. Note: the 'Errors' metric here reflects execution errors reported in summaries (including controls that failed to evaluate and did not return detailed results). The Alerts Center lists only per-result alerts with details, so its 'Errors' count can be lower than this overview.",position:"bottom-start"})]}),e.jsx(Tr,{variant:"light",color:"gray",onClick:()=>s(!0),"aria-label":"Global View Settings",children:e.jsx(nt,{size:16})})]}),l>0&&e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{backgroundColor:c==="dark"?"var(--mantine-color-red-9)":"var(--mantine-color-red-0)",borderColor:c==="dark"?"var(--mantine-color-red-7)":"var(--mantine-color-red-3)"},children:e.jsxs(I,{gap:"sm",align:"center",children:[e.jsx(lt,{color:"red",size:"lg",radius:"md",children:e.jsx(Le,{size:20})}),e.jsxs(N,{gap:2,style:{flex:1},children:[e.jsxs(p,{fw:600,size:"sm",c:c==="dark"?"red.2":"red.8",children:[l," KSI compliance issues require attention"]}),e.jsxs(p,{size:"xs",c:c==="dark"?"red.3":"red.7",children:[m," KSI families affected • Review highest priority items below"]})]}),e.jsx($e,{variant:"light",color:"red",onClick:()=>a("/alerts"),children:"View alerts"})]})}),e.jsxs(rr,{cols:{base:2,sm:4},spacing:"sm",children:[e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{textAlign:"center"},children:e.jsxs(N,{gap:4,align:"center",children:[e.jsxs(ue,{order:2,c:j>=90?"teal":j>=75?"yellow":"red",children:[j,"%"]}),e.jsxs(I,{gap:"xs",align:"center",justify:"center",children:[e.jsx(p,{size:"sm",c:"dimmed",fw:500,children:"Compliance Rate"}),e.jsx(oe,{tooltip:"The percentage of all security checks that are currently passing (OK status). Higher percentages indicate better overall KSI compliance.",size:14})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{textAlign:"center"},children:e.jsxs(N,{gap:4,align:"center",children:[e.jsx(ue,{order:2,c:"red",children:Re.format(o.alarm??0)}),e.jsxs(I,{gap:"xs",align:"center",justify:"center",children:[e.jsx(p,{size:"sm",c:"dimmed",fw:500,children:"Active Alarms"}),e.jsx(oe,{tooltip:"KSI security checks that have found to be non-compliant and require attention. These checks are in 'Alarm' status.",size:14})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{textAlign:"center"},children:e.jsxs(N,{gap:4,align:"center",children:[e.jsx(ue,{order:2,c:"grape",children:Re.format(o.error??0)}),e.jsxs(I,{gap:"xs",align:"center",justify:"center",children:[e.jsx(p,{size:"sm",c:"dimmed",fw:500,children:"Errors"}),e.jsx(oe,{tooltip:"Execution errors aggregated from KSI summaries. Includes controls that reported an error even if no detailed result rows were returned. The Alerts Center 'Errors' count only includes per-result error rows, so it may be lower than this number.",size:14})]})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{textAlign:"center"},children:e.jsxs(N,{gap:4,align:"center",children:[e.jsxs(ue,{order:2,c:"blue",children:[m,"/",r.length]}),e.jsxs(I,{gap:"xs",align:"center",justify:"center",children:[e.jsx(p,{size:"sm",c:"dimmed",fw:500,children:"KSI Families at Risk"}),e.jsx(oe,{tooltip:"The number of KSI families that have active alarms or errors out of the total number of KSI families. This helps identify how widespread security issues are across your system.",size:14})]})]})})]}),i.display.showPriorityActions&&u.length>0&&e.jsxs(N,{gap:"sm",children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(p,{fw:600,size:"lg",children:"Priority Actions"}),e.jsx(oe,{tooltip:"KSI Families with the highest number of security issues that require immediate attention. These are ranked by the total number of alarms and errors.",size:16})]}),e.jsxs(Y,{variant:"light",color:"red",children:[u.length," items"]})]}),e.jsx(N,{gap:"xs",children:u.map((g,h)=>{var _;const f=(_=g.summary)==null?void 0:_.status;((f==null?void 0:f.alarm)??0)+((f==null?void 0:f.error)??0);const A=()=>{t?t(g.group_id):a(`/dashboard/${g.group_id}`)};return e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{cursor:"pointer"},onClick:A,children:e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsxs(I,{gap:"sm",align:"center",children:[e.jsxs(Y,{size:"lg",color:"red",variant:"light",children:["#",h+1]}),e.jsxs(N,{gap:2,children:[e.jsx(p,{fw:500,size:"sm",lineClamp:1,children:ye(g.title)}),e.jsxs(I,{gap:"xs",children:[((f==null?void 0:f.alarm)??0)>0&&e.jsxs(Y,{size:"xs",color:"red",variant:"filled",children:[Re.format((f==null?void 0:f.alarm)??0)," alarms"]}),((f==null?void 0:f.error)??0)>0&&e.jsxs(Y,{size:"xs",color:"grape",variant:"filled",children:[Re.format((f==null?void 0:f.error)??0)," errors"]})]})]})]}),e.jsxs(I,{gap:"sm",align:"center",children:[e.jsxs(p,{size:"sm",c:"dimmed",children:[Math.round(Se(f)),"% OK"]}),e.jsx(Fr,{size:16,color:"var(--mantine-color-dimmed)"})]})]})},g.group_id)})})]}),i.display.showRiskAssessment&&e.jsxs(N,{gap:"sm",children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(p,{fw:600,size:"lg",children:"Risk Assessment"}),e.jsx(oe,{tooltip:"KSI Families are classified by risk level based on the percentage of failed checks. High risk families have the most security issues and should be prioritized for remediation.",size:16})]}),e.jsxs(I,{gap:"xs",children:[e.jsx(Y,{size:"sm",color:"red",variant:"light",children:"High Risk"}),e.jsx(Y,{size:"sm",color:"orange",variant:"light",children:"Medium Risk"}),e.jsx(Y,{size:"sm",color:"yellow",variant:"light",children:"Low Risk"}),e.jsx(Y,{size:"sm",color:"teal",variant:"light",children:"Safe"})]})]}),e.jsx(rr,{cols:{base:2,md:3,lg:4},spacing:"xs",children:k.map(g=>{const h=()=>{t?t(g.id):a(`/dashboard/${g.id}`)},f=z(g.riskCategory);return e.jsx(Z,{withBorder:!0,padding:"sm",radius:"md",style:{cursor:"pointer",borderColor:c==="dark"?`var(--mantine-color-${f}-6)`:`var(--mantine-color-${f}-4)`,borderWidth:2},onClick:h,children:e.jsxs(N,{gap:"xs",children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsx(Y,{size:"xs",color:z(g.riskCategory),variant:"light",children:g.riskCategory}),e.jsxs(p,{size:"xs",c:"dimmed",children:[g.okRate,"%"]})]}),e.jsx(p,{size:"sm",fw:500,lineClamp:2,children:ye(g.title)}),g.problems>0&&e.jsxs(p,{size:"xs",c:"dimmed",children:[g.problems," issues"]})]})},g.id)})})]}),i.display.showDetailedStats&&e.jsxs(N,{gap:"sm",children:[e.jsx(Ee,{}),e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(p,{fw:600,size:"lg",children:"Detailed Statistics"}),e.jsx(oe,{tooltip:"Comprehensive breakdown of all security check results across KSI families, including visual charts and status distributions.",size:16})]}),e.jsxs(rr,{cols:{base:1,md:2},spacing:"md",children:[e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",align:"center",children:[e.jsxs(I,{gap:"xs",align:"center",justify:"center",children:[e.jsx(p,{fw:500,size:"sm",children:"Overall Status Distribution"}),e.jsx(oe,{tooltip:"Donut chart showing the distribution of all security check results: OK (passing), Alarm (warnings), Error (evaluation errors), Skip (not applicable), and Info (informational).",size:14})]}),e.jsx(Ye,{size:180,data:[{name:"OK",value:o.ok??0,color:"teal.6"},{name:"Alarm",value:o.alarm??0,color:"red.6"},{name:"Error",value:o.error??0,color:"grape.6"},{name:"Skip",value:o.skip??0,color:"gray.6"},{name:"Info",value:o.info??0,color:"blue.6"}],thickness:24,withTooltip:!0,children:e.jsxs(N,{align:"center",gap:0,children:[e.jsx(ue,{order:3,children:Re.format(b)}),e.jsx(p,{size:"xs",c:"dimmed",children:"total checks"})]})})]})}),e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",children:e.jsxs(N,{gap:"sm",children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(p,{fw:500,size:"sm",children:"Status Breakdown"}),e.jsx(oe,{tooltip:"Detailed view of security check results with status pills showing counts and a progress bar indicating the proportion of each status type.",size:14})]}),e.jsx(We,{status:o}),e.jsx(fa,{status:o,height:20,radius:10})]})})]})]}),e.jsx(ma,{opened:n,onClose:()=>s(!1)})]})})}function Ia({group:r,onOpen:t}){var c;const a=(c=r.summary)==null?void 0:c.status,i=[{name:"OK",value:(a==null?void 0:a.ok)??0,color:"teal.6"},{name:"Alarm",value:(a==null?void 0:a.alarm)??0,color:"red.6"},{name:"Error",value:(a==null?void 0:a.error)??0,color:"grape.6"}],n=ze(a),s=Math.round(Se(a));return e.jsx(Z,{withBorder:!0,padding:"lg",radius:"md",onClick:()=>t(r),style:{cursor:"pointer",height:"400px",display:"flex",flexDirection:"column"},children:e.jsxs(N,{gap:"xs",style:{height:"100%",justifyContent:"space-between"},children:[e.jsxs(N,{gap:"xs",children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsxs(I,{gap:"xs",align:"center",style:{flex:1,minWidth:0},children:[e.jsx(ue,{order:4,lineClamp:2,style:{flex:1,minWidth:0},children:ye(r.title)}),e.jsx(oe,{tooltip:`This category shows security compliance checks for ${ye(r.title)}. The donut chart displays the distribution of check results: OK (passing), Alarm (warnings), and Error (evaluation errors). The percentage badge shows the overall compliance rate.`,position:"top-start"})]}),e.jsxs(Y,{color:s>=90?"teal":s>=70?"yellow":"red",children:[s,"% OK"]})]}),e.jsx(p,{c:"dimmed",lineClamp:2,style:{minHeight:"2.4em"},children:Pe(r.description)})]}),e.jsx(N,{gap:"xs",align:"center",style:{flex:1,justifyContent:"center"},children:e.jsx(Ye,{size:140,data:i,thickness:24,withTooltip:!0,children:e.jsxs(N,{align:"center",gap:0,children:[e.jsx(ue,{order:3,children:n}),e.jsx(p,{size:"xs",c:"dimmed",children:"checks"})]})})}),e.jsx(We,{status:a})]})})}function Na({group:r}){var c;const t=wr(),{categoryId:a}=Zr(),[i]=qr(),n=i.get("control")??void 0;if(!r)return null;const s=(c=r.summary)==null?void 0:c.status;return e.jsxs(N,{children:[e.jsx(ue,{order:3,children:ye(r.title)}),r.description&&e.jsx(p,{c:"dimmed",children:Pe(r.description)}),e.jsx(Ee,{my:"sm"}),e.jsxs(te,{defaultValue:"overview",children:[e.jsxs(te.List,{children:[e.jsx(te.Tab,{value:"overview",children:"Overview"}),e.jsx(te.Tab,{value:"raw",children:"Raw"})]}),e.jsx(te.Panel,{value:"overview",pt:"sm",children:e.jsxs(N,{gap:"lg",children:[e.jsxs(N,{gap:"sm",children:[e.jsx(We,{status:s}),e.jsxs(p,{size:"sm",c:"dimmed",children:["OK rate: ",Math.round(Se(s)),"%"]})]}),r.groups&&r.groups.length>0&&e.jsxs(N,{gap:"sm",children:[e.jsx(Ee,{}),e.jsx(p,{fw:600,size:"lg",children:"Sub-groups"}),r.groups.map(d=>{var o;return e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{cursor:"pointer"},onClick:()=>t(`/dashboard/${a||r.group_id}/${d.group_id}`),children:e.jsxs(N,{gap:6,children:[e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsx(p,{fw:600,children:ye(d.title)}),e.jsx(Fr,{size:16,color:"var(--mantine-color-dimmed)"})]}),d.description&&e.jsx(p,{size:"sm",c:"dimmed",children:Pe(d.description)}),e.jsx(We,{status:(o=d.summary)==null?void 0:o.status})]})},d.group_id)})]}),r.controls&&r.controls.length>0&&e.jsxs(N,{gap:"sm",children:[e.jsx(Ee,{}),e.jsxs(I,{justify:"space-between",align:"center",children:[e.jsx(p,{fw:600,size:"lg",children:"Controls"}),e.jsxs(Y,{variant:"light",color:"blue",children:[r.controls.length," controls"]})]}),r.controls.map(d=>{var l;const o=d.summary,u=((o==null?void 0:o.alarm)??0)>0,b=u||((o==null?void 0:o.error)??0)>0?"red":((o==null?void 0:o.ok)??0)>0?"teal":"gray",j=n&&d.control_id===n;return e.jsx(Z,{withBorder:!0,padding:"md",radius:"md",style:{borderLeft:`4px solid var(--mantine-color-${b}-6)`,boxShadow:j?"0 0 0 2px var(--mantine-color-yellow-4) inset":void 0},children:e.jsxs(N,{gap:"sm",children:[e.jsxs(I,{justify:"space-between",align:"start",children:[e.jsxs(N,{gap:4,style:{flex:1},children:[e.jsx(p,{fw:600,size:"sm",children:ye(d.title)}),d.description&&e.jsx(p,{size:"xs",c:"dimmed",lineClamp:2,children:Pe(d.description)})]}),((l=d.tags)==null?void 0:l.severity)&&u&&e.jsx(Y,{size:"sm",color:d.tags.severity==="high"?"red":d.tags.severity==="medium"?"orange":"yellow",variant:"light",children:d.tags.severity})]}),e.jsxs(I,{gap:"xs",children:[((o==null?void 0:o.ok)??0)>0&&e.jsxs(Y,{size:"xs",color:"teal",variant:"filled",leftSection:e.jsx(ur,{size:12}),children:[(o==null?void 0:o.ok)??0," OK"]}),((o==null?void 0:o.alarm)??0)>0&&e.jsxs(Y,{size:"xs",color:"red",variant:"filled",leftSection:e.jsx(Le,{size:12}),children:[(o==null?void 0:o.alarm)??0," Alarm"]}),((o==null?void 0:o.error)??0)>0&&e.jsxs(Y,{size:"xs",color:"grape",variant:"filled",leftSection:e.jsx(_e,{size:12}),children:[(o==null?void 0:o.error)??0," Error"]}),((o==null?void 0:o.skip)??0)>0&&e.jsxs(Y,{size:"xs",color:"gray",variant:"filled",leftSection:e.jsx(mr,{size:12}),children:[(o==null?void 0:o.skip)??0," Skip"]}),((o==null?void 0:o.info)??0)>0&&e.jsxs(Y,{size:"xs",color:"blue",variant:"filled",leftSection:e.jsx(qe,{size:12}),children:[(o==null?void 0:o.info)??0," Info"]})]}),d.run_error&&e.jsx(Z,{withBorder:!0,padding:"xs",radius:"sm",style:{backgroundColor:"var(--mantine-color-grape-light)",borderColor:"var(--mantine-color-grape-light-color)"},children:e.jsxs(N,{gap:4,children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(_e,{size:14,color:"var(--mantine-color-grape-6)"}),e.jsx(p,{size:"xs",fw:500,c:"grape",children:"Control Execution Error"})]}),e.jsx(p,{size:"xs",c:"dimmed",style:{fontFamily:"monospace",whiteSpace:"pre-wrap"},children:d.run_error})]})}),d.results&&d.results.filter(m=>m.status==="error").length>0&&e.jsx(Z,{withBorder:!0,padding:"xs",radius:"sm",style:{backgroundColor:"var(--mantine-color-grape-light)",borderColor:"var(--mantine-color-grape-light-color)"},children:e.jsxs(N,{gap:4,children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(_e,{size:14,color:"var(--mantine-color-grape-6)"}),e.jsxs(p,{size:"xs",fw:500,c:"grape",children:["Error Results (",d.results.filter(m=>m.status==="error").length,")"]})]}),d.results.filter(m=>m.status==="error").slice(0,3).map((m,z)=>e.jsxs(ge,{style:{paddingLeft:"16px"},children:[e.jsx(p,{size:"xs",fw:500,c:"grape",children:m.reason}),m.resource&&e.jsxs(p,{size:"xs",c:"dimmed",children:["Resource: ",m.resource]})]},z)),d.results.filter(m=>m.status==="error").length>3&&e.jsxs(p,{size:"xs",c:"dimmed",style:{paddingLeft:"16px"},children:["... and ",d.results.filter(m=>m.status==="error").length-3," more errors"]})]})}),d.results&&d.results.filter(m=>m.status==="alarm").length>0&&e.jsx(Z,{withBorder:!0,padding:"xs",radius:"sm",style:{backgroundColor:"var(--mantine-color-red-light)",borderColor:"var(--mantine-color-red-light-color)"},children:e.jsxs(N,{gap:4,children:[e.jsxs(I,{gap:"xs",align:"center",children:[e.jsx(Le,{size:14,color:"var(--mantine-color-red-6)"}),e.jsxs(p,{size:"xs",fw:500,c:"red",children:["Alarm Results (",d.results.filter(m=>m.status==="alarm").length,")"]})]}),d.results.filter(m=>m.status==="alarm").slice(0,3).map((m,z)=>e.jsxs(ge,{style:{paddingLeft:"16px"},children:[e.jsx(p,{size:"xs",fw:500,c:"red",children:m.reason}),m.resource&&e.jsxs(p,{size:"xs",c:"dimmed",children:["Resource: ",m.resource]})]},z)),d.results.filter(m=>m.status==="alarm").length>3&&e.jsxs(p,{size:"xs",c:"dimmed",style:{paddingLeft:"16px"},children:["... and ",d.results.filter(m=>m.status==="alarm").length-3," more alarms"]})]})})]})},d.control_id)})]})]})}),e.jsx(te.Panel,{value:"raw",pt:"sm",style:{height:"calc(100vh - 300px)",display:"flex"},children:e.jsx(Ar,{style:{flex:1},children:e.jsx(Qe,{code:JSON.stringify(r,null,2),language:"json",withCopyButton:!0,style:{height:"100%"}})})})]})]})}export{ka as G,Ia as K,Pe as a,Sa as b,ye as c,Na as d,Se as o,ze as t};
